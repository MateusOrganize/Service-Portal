<?xml version="1.0" encoding="UTF-8"?><unload unload_date="2021-02-02 19:29:13">
<sys_remote_update_set action="INSERT_OR_UPDATE">
<application display_value="Global">global</application>
<application_name>Global</application_name>
<application_scope>global</application_scope>
<application_version/>
<collisions/>
<commit_date/>
<deleted/>
<description/>
<inserted/>
<name>ACN: Page - Tickets</name>
<origin_sys_id/>
<parent display_value=""/>
<release_date/>
<remote_base_update_set display_value=""/>
<remote_parent_id/>
<remote_sys_id>cd03740d070220107a0af0269c1ed00e</remote_sys_id>
<state>loaded</state>
<summary/>
<sys_class_name>sys_remote_update_set</sys_class_name>
<sys_created_by>mateus.anzolin</sys_created_by>
<sys_created_on>2021-02-02 19:29:12</sys_created_on>
<sys_id>bb26919607c220107a0af0269c1ed0dd</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>mateus.anzolin</sys_updated_by>
<sys_updated_on>2021-02-02 19:29:12</sys_updated_on>
<update_set display_value=""/>
<update_source display_value=""/>
<updated/>
</sys_remote_update_set>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sp_widget_d03e56721bd09410b9da23853a4bcb6c</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sp_widget"&gt;&lt;sp_widget action="INSERT_OR_UPDATE"&gt;&lt;category&gt;custom&lt;/category&gt;&lt;client_script&gt;&lt;![CDATA[function (spUtil,$scope) {
	/* widget controller */
	var c = this;
	c.typeAction = '';
	c.comments = '';
	c.accept = function(){
		c.data.action = 'accept';
		c.data.comments = 'Solução aprovada pelo usuário.';
		this.server.update().then(function(){
			c.data.action = '';
			c.data.comments = '';
			c.comments = '';
		});
	};
	
	c.reject = function(){
		c.data.action = 'reject';
		c.data.comments = c.comments;
		this.server.update().then(function(){
			c.data.action = '';
			c.data.comments = '';
		});
	};
	
	c.cancel = function(){
		c.data.action = 'cancel';
		c.data.comments = c.comments;
		this.server.update().then(function(){
			c.data.action = '';
			c.data.comments = '';
			c.comments = '';
		});
	};
}]]&gt;&lt;/client_script&gt;&lt;controller_as&gt;c&lt;/controller_as&gt;&lt;css&gt;.box-content{
  border-top: 6px solid $cyan;
}

.group-buttons{
  margin: 0 auto;
  display: block;

  .btn{
    width: 100%;
    padding: 8px 30px;
    transition: all .8s;
    margin-bottom: 5px;

    img{
      width: 20px;
      margin-right: 10px;
    }
  }

  .btn:hover{
    opacity: 0.8;
  }
}

.group-buttons:last-child{
  padding-bottom: 30px;
}

.cancel{
  background-color: #d45454;
  margin-right: 22px;
  border-radius: 3px;
  color: white;
  i{
  	margin-right: 8px;
  }
}

.accept{
  background-color: #18b16f;
  margin-right: 22px;
  border-radius: 3px;
  color: white;

  span{
    margin-top: 1px;
  }
}

.reject{
  background-color: #E0DDD7;
  border-radius: 3px;
  border-color: rgba(42, 36, 33, 0.75);
  color: rgb(31, 30, 30);

  .i{
    font-size: 19px;
    margin-right: 8px;
  }
}

.text-field{
  margin: 0 auto;
  display: table;
  width: 286px;
  position: relative;
  top: -20px;
  label{
    color: $danger;
    padding: 5px 10px;
    padding-bottom: 0;
    margin: 0;
    background: white;
    position: relative;
    top: 9px;
    left: 15px;
  }
  .textarea{
    border: 1px solid $danger;
    width: 100%;
    height: 95px;
    border-radius: 15px;
    padding: 8px 7px;
  }

}

.group-actions{
  margin: 0 auto;
  display: table;
  margin-bottom: 24px;
  margin-top: 14px;

  width: 286px;
  .btn-primary{
    margin-right: 10px;
  }
}

.modal-title{
  float: left;
  font-size: 18px;
}

//justification
.justification{
  height: 95px;
  resize: none;
  font-size: 14px;
  width: 100%;
  border-radius: 6px;
  padding: 5px 8px;
  color: black;
}

.justification:focus{
  border: 1px solid $secondary;
}


@media only screen and (max-width: 1200px){
  .group-buttons .btn{
    padding: 8px 10px;
    font-size: 13px;
    img{
      width: 18px;
      margin-right: 2px;
    }
  }
}
&lt;/css&gt;&lt;data_table&gt;sp_instance&lt;/data_table&gt;&lt;demo_data/&gt;&lt;description/&gt;&lt;docs/&gt;&lt;field_list/&gt;&lt;has_preview&gt;false&lt;/has_preview&gt;&lt;id&gt;acn_accept_or_reject&lt;/id&gt;&lt;internal&gt;false&lt;/internal&gt;&lt;link&gt;&lt;![CDATA[function link(scope, element, attrs, controller) {  }]]&gt;&lt;/link&gt;&lt;name&gt;ACN Accept or Reject&lt;/name&gt;&lt;option_schema&gt;[]&lt;/option_schema&gt;&lt;public&gt;false&lt;/public&gt;&lt;roles/&gt;&lt;script&gt;&lt;![CDATA[(function() {

	//CORE ------------------
	data.table = $sp.getParameter('table') ||  $sp.getParameter('tab') ||  $sp.getParameter('t');
	data.sys_id = $sp.getParameter('sys_id') ||  $sp.getParameter('id') ||  $sp.getParameter('i');

	//IF INPUT == FALSE 
	if(gs.nil(input)) {	
		var isReqOrInc = (data.table == 'incident' || data.table == 'sc_req_item');
		data.show = true;

		//VALIDATION ------------------
		var grRecord = new GlideRecord(data.table);
		grRecord.get(data.sys_id);

		if(!isReqOrInc || !grRecord.isValid() || !grRecord.canRead() || !grRecord.canWrite()){
			data.show = false;
			return;
		}

		var isTheOwner = false;
		if(data.table == 'incident'){
			if(grRecord.getValue('caller_id') == gs.getUserID())
				isTheOwner = true;
		}else{
			var req = new GlideRecord('sc_request');
			req.get(grRecord.getValue('request'));
			if(req.getValue('requested_for') == gs.getUserID())
				isTheOwner = true;
		}

		if(!isTheOwner){
			data.show = false;
			return;
		}

		//CAN SHOW ACCEPT ? ------------------
		var state = grRecord.getValue('state');
		if (data.table == 'incident')
			data.enableApproval = (state == 6 ? true : false);
		else
			data.enableApproval = false; //PUT THE RITM STATES HETE LIKE:
																	//((state == 3 ||  state == 4 || state == 7)? true : false) 
	}


	//IF INPUT == TRUE ------------------------------------------------------
	var gr = new GlideRecord(data.table);
	gr.get(data.sys_id);

	
	//ACCEPT
	if(input.action == 'accept'){
		if(data.table == 'incident')
			gr.setValue('state',7);

		else 
			gr.setValue('state',3);
		
		gr.setDisplayValue('comments',input.comments);
		gr.update();
	}

	//REJECT
	if(input.action == 'reject'){
		if(input.table == 'incident')
			gr.setValue('state',2);
		else 
			gr.setValue('state',2);

		gr.setDisplayValue('comments',input.comments);
		gr.update();
	}
	
	//CANCEL
	if(input.action == 'cancel'){
		if(input.table == 'incident')
			gr.setValue('state',8);
		else 
			gr.setValue('state',7);

		gr.setDisplayValue('comments',input.comments);
		gr.update();
	}
	
})();]]&gt;&lt;/script&gt;&lt;servicenow&gt;false&lt;/servicenow&gt;&lt;sys_class_name&gt;sp_widget&lt;/sys_class_name&gt;&lt;sys_created_by&gt;willian@organizecloudlabs.com&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2020-04-24 17:59:45&lt;/sys_created_on&gt;&lt;sys_id&gt;d03e56721bd09410b9da23853a4bcb6c&lt;/sys_id&gt;&lt;sys_mod_count&gt;370&lt;/sys_mod_count&gt;&lt;sys_name&gt;ACN Accept or Reject&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sp_widget_d03e56721bd09410b9da23853a4bcb6c&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;mateus.anzolin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2021-02-02 19:20:20&lt;/sys_updated_on&gt;&lt;template&gt;&lt;![CDATA[&lt;div class="req-approval" ng-if="data.show" &gt;
  &lt;div class="group-buttons"  ng-if="data.enableApproval"&gt;
    &lt;button ng-click="c.accept()" class="btn accept"&gt;
      &lt;img src="accept-icon.svg"/&gt; 
      &lt;span&gt;${Aceitar Solução}&lt;/span&gt;
    &lt;/button&gt;
    &lt;button data-toggle="modal" data-target="#modalReasonReject" ng-click="c.typeAction='reject'" class="btn reject"&gt;
      &lt;img src="reject-icon.svg"/&gt; 
      &lt;span&gt;${Reabrir chamado}&lt;/span&gt;
    &lt;/button&gt;
  &lt;/div&gt;
  &lt;div class="group-buttons"&gt;
    &lt;button class="btn cancel"  data-toggle="modal"data-target="#modalReasonReject" ng-click="c.typeAction='cancel'"&gt;
      &lt;i class="fa fa-ban"&gt;&lt;/i&gt; 
      &lt;span&gt;${Cancelar chamado}&lt;/span&gt;
    &lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Modal Reject Reason --&gt;
&lt;div class="modal fade" id="modalReasonReject" role="dialog"&gt;
  &lt;div class="modal-dialog"&gt;
    &lt;!-- Modal content--&gt;
    &lt;div class="modal-content"&gt;
      &lt;div class="modal-header"&gt;
        &lt;button type="button" class="close" data-dismiss="modal"&gt;
          &lt;i class="fa fa-times" aria-hidden="true" data-dismiss="modal"&gt;&lt;/i&gt;
        &lt;/button&gt;
        &lt;h4 class="modal-title"&gt;&lt;i class="fa fa-exclamation-triangle" aria-hidden="true"&gt;&lt;/i&gt; ${Attention}&lt;/h4&gt;
      &lt;/div&gt;
      &lt;div class="modal-body"&gt;
        &lt;div class="form-group"&gt;
          &lt;span style="color:red"&gt;*&lt;/span&gt;&lt;label&gt;${Provide a reason for rejection}.&lt;/label&gt;
          &lt;textarea class="form-control justification" rows="3" ng-model="c.comments"&gt;&lt;/textarea&gt;
        &lt;/div&gt;
      &lt;/div&gt;
      &lt;div class="modal-footer .group-actions"&gt;
        &lt;button type="button" class="btn btn-primary" data-dismiss="modal" ng-disabled="c.comments==''" ng-if="c.typeAction=='reject'" ng-click="c.reject()"&gt; ${Confirm}&lt;/button&gt;
        &lt;button type="button" class="btn btn-primary" data-dismiss="modal" ng-disabled="c.comments==''" ng-if="c.typeAction=='cancel'" ng-click="c.cancel()"&gt; ${Confirm}&lt;/button&gt;
        &lt;button type="button" class="btn btn-secondary" data-dismiss="modal"&gt; ${Cancel}&lt;/button&gt;
      &lt;/div&gt;
    &lt;/div&gt;      
  &lt;/div&gt;
&lt;/div&gt;
]]&gt;&lt;/template&gt;&lt;/sp_widget&gt;&lt;/record_update&gt;</payload>
<payload_hash>-1837630920</payload_hash>
<remote_update_set display_value="ACN: Page - Tickets">bb26919607c220107a0af0269c1ed0dd</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>mateus.anzolin</sys_created_by>
<sys_created_on>2021-02-02 19:29:13</sys_created_on>
<sys_id>3326919607c220107a0af0269c1ed0e1</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>1776430424d0000001</sys_recorded_at>
<sys_updated_by>mateus.anzolin</sys_updated_by>
<sys_updated_on>2021-02-02 19:29:13</sys_updated_on>
<table/>
<target_name>ACN Accept or Reject</target_name>
<type>Widget</type>
<update_domain>global</update_domain>
<update_guid>b5245196dbc220107fb30348021b40b5</update_guid>
<update_guid_history>b5245196dbc220107fb30348021b40b5:-1837630920,9bd09dd210c220103b8dc310f077c95e:1047735098,6ea0d99236c2201066b902acb433cd33:1433518989,554091d2bdc22010ca2c13e4d3871992:319380988,0f9ec592f5c220109772a3e37910195f:-812941187,9d6a459ec7822010bf167046118bba9c:1190828286,539901de3282201045b87137100892d9:1667943201,ef594d9ed38220104ee85328b3c4b1f0:-1098475470,f9398d9e61822010401643dafd44b6ac:497670628,b5294d9e6482201007876d702d4594e9:-1662045786,1bd8459e618220107ce9679a80405a1e:-742636254,8158cdda11822010d1ddc7bcf518ff3e:281699536,13f78d1e118220106bd5cede15755b7c:-1904660435,bdb78d5eb5822010cbfd0e74febdfa8a:1328330604,fa054dda47822010d05a27a3b7117247:-1771306138,67b0015a2c8220107600f43863ad3555:-1162298173,c2b0c91aed82201085a8b68060e65b8a:8207583,d780c91a358220107bee64d01195a141:-513911153,9450451a04822010585d8d32dced6c11:1716478504,7a30891a9f82201084e4c0cd7fe4d041:816010099,dccff8d67c822010a66b923b366f829c:-660753838,208f701a648220102a3f7cc528406bf4:-231636146,601ff4d6ee822010fb5519f76c74c4d4:683544911,17ee74d6ff8220101d40e9721bbb50a2:-1864660266,5dc9050d0f4220108bc6e7225344b220:-424501906,ee79010d53422010883a614145e369d3:-383620643,dd4909c9ea42201059410c72bae75f56:1085507261,d7a801c9eb422010cbe5ab6be8c925e7:1130262322,5e8805c98c422010bee76e341d059473:-1443545643,fb7805c98b422010a11928eb60ab85d6:1084567415,b6c70d8954422010e6af0c1d180c70b9:98000374,ced23cc9b20220109b665412320c5fdf:2096735125</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sp_row_9283340d070220107a0af0269c1ed06b</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_row"><sp_row action="INSERT_OR_UPDATE"><class_name/><order>1</order><sp_column/><sp_container display_value="ACN Tickets - Container 1">d773740d070220107a0af0269c1ed0e4</sp_container><sys_class_name>sp_row</sys_class_name><sys_created_by>mateus.anzolin</sys_created_by><sys_created_on>2021-01-29 19:45:25</sys_created_on><sys_id>9283340d070220107a0af0269c1ed06b</sys_id><sys_mod_count>0</sys_mod_count><sys_name>1</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sp_row_9283340d070220107a0af0269c1ed06b</sys_update_name><sys_updated_by>mateus.anzolin</sys_updated_by><sys_updated_on>2021-01-29 19:45:25</sys_updated_on></sp_row></record_update>]]></payload>
<payload_hash>-834510212</payload_hash>
<remote_update_set display_value="ACN: Page - Tickets">bb26919607c220107a0af0269c1ed0dd</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>mateus.anzolin</sys_created_by>
<sys_created_on>2021-02-02 19:29:13</sys_created_on>
<sys_id>3726919607c220107a0af0269c1ed0e0</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>1774fadc95a0000001</sys_recorded_at>
<sys_updated_by>mateus.anzolin</sys_updated_by>
<sys_updated_on>2021-02-02 19:29:13</sys_updated_on>
<table/>
<target_name>1</target_name>
<type>Row</type>
<update_domain>global</update_domain>
<update_guid>1283f80d060220106003ea0737fa77aa</update_guid>
<update_guid_history>1283f80d060220106003ea0737fa77aa:-834510212</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sp_instance_3924f80d070220107a0af0269c1ed0b2</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sp_instance"&gt;&lt;sp_instance action="INSERT_OR_UPDATE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;class_name/&gt;&lt;color&gt;default&lt;/color&gt;&lt;css/&gt;&lt;glyph/&gt;&lt;id/&gt;&lt;order&gt;1&lt;/order&gt;&lt;roles/&gt;&lt;short_description/&gt;&lt;size&gt;md&lt;/size&gt;&lt;sp_column display_value="2"&gt;1683f80d070220107a0af0269c1ed0ad&lt;/sp_column&gt;&lt;sp_widget display_value="ACN Ticket Fiels"&gt;694f287e1b796050c7bbea8ce54bcb0b&lt;/sp_widget&gt;&lt;sys_class_name&gt;sp_instance&lt;/sys_class_name&gt;&lt;sys_created_by&gt;mateus.anzolin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2021-01-29 19:48:07&lt;/sys_created_on&gt;&lt;sys_id&gt;3924f80d070220107a0af0269c1ed0b2&lt;/sys_id&gt;&lt;sys_mod_count&gt;2&lt;/sys_mod_count&gt;&lt;sys_name/&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sp_instance_3924f80d070220107a0af0269c1ed0b2&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;mateus.anzolin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2021-02-02 18:18:47&lt;/sys_updated_on&gt;&lt;title/&gt;&lt;url/&gt;&lt;widget_parameters&gt;&lt;![CDATA[{
	"pickup_msg": {
		"value": "",
		"displayValue": ""
	}
}]]&gt;&lt;/widget_parameters&gt;&lt;/sp_instance&gt;&lt;sys_translated_text action="delete_multiple" query="documentkey=3924f80d070220107a0af0269c1ed0b2"/&gt;&lt;/record_update&gt;</payload>
<payload_hash>-146322695</payload_hash>
<remote_update_set display_value="ACN: Page - Tickets">bb26919607c220107a0af0269c1ed0dd</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>mateus.anzolin</sys_created_by>
<sys_created_on>2021-02-02 19:29:13</sys_created_on>
<sys_id>3b26919607c220107a0af0269c1ed0df</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>17763f7e8530000001</sys_recorded_at>
<sys_updated_by>mateus.anzolin</sys_updated_by>
<sys_updated_on>2021-02-02 19:29:13</sys_updated_on>
<table/>
<target_name/>
<type>Instance</type>
<update_domain>global</update_domain>
<update_guid>0c160d1ec2822010e3871a71a4d638ac</update_guid>
<update_guid_history>0c160d1ec2822010e3871a71a4d638ac:-146322695,a80609dac98220108b167e384df6cdb7:-1533949745,3d24f80d19022010accf1b87f1bce6b3:-647139060</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sp_column_1683f80d070220107a0af0269c1ed0ad</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_column"><sp_column action="INSERT_OR_UPDATE"><class_name/><order>2</order><size>3</size><size_lg/><size_sm/><size_xs/><sp_row display_value="1">9283340d070220107a0af0269c1ed06b</sp_row><sys_class_name>sp_column</sys_class_name><sys_created_by>mateus.anzolin</sys_created_by><sys_created_on>2021-01-29 19:45:25</sys_created_on><sys_id>1683f80d070220107a0af0269c1ed0ad</sys_id><sys_mod_count>0</sys_mod_count><sys_name>2</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sp_column_1683f80d070220107a0af0269c1ed0ad</sys_update_name><sys_updated_by>mateus.anzolin</sys_updated_by><sys_updated_on>2021-01-29 19:45:25</sys_updated_on></sp_column></record_update>]]></payload>
<payload_hash>-621095899</payload_hash>
<remote_update_set display_value="ACN: Page - Tickets">bb26919607c220107a0af0269c1ed0dd</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>mateus.anzolin</sys_created_by>
<sys_created_on>2021-02-02 19:29:13</sys_created_on>
<sys_id>3f26919607c220107a0af0269c1ed0de</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>1774fadc9c40000001</sys_recorded_at>
<sys_updated_by>mateus.anzolin</sys_updated_by>
<sys_updated_on>2021-02-02 19:29:13</sys_updated_on>
<table/>
<target_name>2</target_name>
<type>Column</type>
<update_domain>global</update_domain>
<update_guid>d283f80d0c022010dc39affd9a9e03ae</update_guid>
<update_guid_history>d283f80d0c022010dc39affd9a9e03ae:-621095899</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sp_rel_widget_clone_dd74704d070220107a0af0269c1ed0c5</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_rel_widget_clone"><sp_rel_widget_clone action="INSERT_OR_UPDATE"><child display_value="Copy of Ticket Attachments">dd74704d070220107a0af0269c1ed0bf</child><cloned>2021-01-29 19:49:27</cloned><last_validated>2021-01-29 19:49:27</last_validated><parent display_value="Ticket Attachments">9ee37281d7033100a9ad1e173e24d457</parent><payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;sp_widget&gt;&lt;category&gt;standard&lt;/category&gt;&lt;client_script&gt;&lt;![CDATA[function attachMate($scope, nowAttachmentHandler, $rootScope, spUtil, spModal, $log, spAriaUtil,$document) {
	$scope.errorMessages = [];
	$scope.attachmentHandler = new nowAttachmentHandler(setAttachments, appendError);
	$scope.data.action = "";

	spUtil.recordWatch($scope, "sys_attachment", "table_sys_id=" + $scope.data.sys_id, function(response, data) {
		$scope.attachmentHandler.getAttachmentList();
		if (response.data) {
			var options = {};
			options.operation = response.data.operation;
			options.filename = response.data.display_value;
			options.sys_id = $scope.data.sys_id;
			options.table = $scope.data.table; 
			options.state = (response.data.record &amp;&amp; response.data.record.state) ? response.data.record.state.value : "";
			//broadcast only if operation is update...we don't need insert and other record updates for now
			if (options.operation === "update" &amp;&amp; options.state === "not_available")
			$rootScope.$broadcast("attachment.updated",options);
		}
	});

	$scope.$evalAsync(function() {
		$scope.attachmentHandler.setParams($scope.data.table, $scope.data.sys_id, 1024 * 1024 * $scope.data.maxAttachmentSize);
		$scope.attachmentHandler.getAttachmentList();
	});

	$scope.hasAttachments = function() {
		return $scope.attachments &amp;&amp; $scope.attachments.length != 0;
	};

	$scope.canWrite = function() {
		return $scope.data.canWrite;
	};

	$scope.dropFiles = function(files) {
		if (!$scope.data.canDragAndDrop) {
			spUtil.addInfoMessage(data.noDragDropMsg);
			return;
		}
		$scope.attachmentHandler.onFileSelect(files);
	}
	
	$scope.confirmDeleteAttachment = function(attachment) {
		var appendTo = $scope.data.appendToId ? $document.find('#'+$scope.data.appendToId) : null;
		spModal.confirm("${Delete Attachment?}",  appendTo).then(function() {
				$scope.attachmentHandler.deleteAttachment(attachment);
		});
	};

	$scope.$on('dialog.upload_too_large.show', function(e){
		$log.error($scope.data.largeAttachmentMsg);
		spUtil.addErrorMessage($scope.data.largeAttachmentMsg);
	});

	$scope.$on('added_attachment', function(evt) {
		$scope.data.action = "added";
		spUtil.update($scope);
	});
	
	$scope.$on('sn.attachment.scanned', function(evt) {
		$scope.attachmentHandler.getAttachmentList("list");
	});
	
	$scope.$on('sp.record.can_write', function(evt, answer) {
		$scope.data.canWrite = answer;
	});

	function appendError(error) {
		$scope.errorMessages.push(error);
		spUtil.addErrorMessage(error.msg + error.fileName);
	}

	function setAttachments(attachments, action) {
		if ($scope.submitting == true)
			return;

		$scope.attachments = attachments;
		if (!action)
			return;
		
		if (action === "added") {
			spAriaUtil.sendLiveMessage($scope.data.attachmentSuccessMsg);
		}

		$scope.data.action = action;
		spUtil.update($scope);
	}
}]]&gt;&lt;/client_script&gt;&lt;controller_as/&gt;&lt;css&gt;.sp-drop-area {
  display: block;
  padding: 30px;
  width: 100%;
  border: 1px dashed $panel-default-border;
}&lt;/css&gt;&lt;data_table&gt;sp_instance&lt;/data_table&gt;&lt;demo_data/&gt;&lt;description/&gt;&lt;docs/&gt;&lt;field_list/&gt;&lt;has_preview&gt;false&lt;/has_preview&gt;&lt;id&gt;widget-ticket-attachments&lt;/id&gt;&lt;internal&gt;false&lt;/internal&gt;&lt;link/&gt;&lt;name&gt;Ticket Attachments&lt;/name&gt;&lt;option_schema&gt;[{"hint":"ID of referenced record","name":"record_id","section":"Data","label":"Record ID","type":"string"},{"hint":"Table name of referenced record","name":"record_table","section":"Data","label":"Record Table","type":"string"}]&lt;/option_schema&gt;&lt;public&gt;false&lt;/public&gt;&lt;roles&gt;snc_external,snc_internal&lt;/roles&gt;&lt;script&gt;&lt;![CDATA[(function() {
	data.sys_id = input.sys_id || options.record_id || $sp.getParameter("sys_id");
	data.table = input.table || options.record_table || $sp.getParameter("table");
	data.appendToId = options.appendToId;
	data.table = _getActualTable(data.table, data.sys_id);
	data.maxAttachmentSize = parseInt(gs.getProperty("com.glide.attachment.max_size", 1024));
	if (isNaN(data.maxAttachmentSize))
		data.maxAttachmentSize = 24;
	data.largeAttachmentMsg = gs.getMessage("Attached files must be smaller than {0} - please try again", "" + data.maxAttachmentSize + "MB");
	data.attachmentSuccessMsg = gs.getMessage("Attachment successfully uploaded");
	data.noDragDropMsg = gs.getMessage("Attachment drap-and-drop not enabled - use attachment button");
	data.noAttachmentsMsg = gs.getMessage("There are no attachments");
	
	if (!data.table || !data.sys_id)
		return;

	var gr = new GlideRecord(data.table);
	if (!gr.isValid())
		return;
	
	if (!gr.get(data.sys_id))
		return;

	if (input &amp;&amp; input.action == "deleted") {
		gr.comments = input.action + " an attachment";
		gr.update();
	}

	data.canWrite = gr.canWrite();
	data.canAttach = gs.hasRole(gs.getProperty("glide.attachment.role")) &amp;&amp; GlideTableDescriptor.get(data.table).getED().getAttribute("no_attachment") != "true";
	data.canRead = gr.canRead();
	data.canDragAndDrop = gs.getProperty('glide.ui.attachment_drag_and_drop', 'true') === 'true';

	function _getActualTable(table, id) {
		if (!table)
			return table;
		
		var rec = new GlideRecord(table);
		if (!rec.isValid())
			return table;
		
		if (rec.get(id) &amp;&amp; rec.getValue('sys_class_name')) {
			return rec.getValue('sys_class_name');
		}
		return table;
	}
})();]]&gt;&lt;/script&gt;&lt;servicenow&gt;true&lt;/servicenow&gt;&lt;sys_class_name&gt;sp_widget&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2015-03-25 16:06:34&lt;/sys_created_on&gt;&lt;sys_id&gt;9ee37281d7033100a9ad1e173e24d457&lt;/sys_id&gt;&lt;sys_mod_count&gt;153&lt;/sys_mod_count&gt;&lt;sys_name&gt;Ticket Attachments&lt;/sys_name&gt;&lt;sys_package display_value="Service Portal - Core" source="com.glide.service-portal"&gt;cfaf5f5fd83610100c1d056eb83723cd&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sp_widget_9ee37281d7033100a9ad1e173e24d457&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2019-07-29 17:39:55&lt;/sys_updated_on&gt;&lt;template&gt;&lt;![CDATA[&lt;div ng-if="data.canRead" class="panel panel-{{options.color}} b"&gt;
  &lt;div class="panel-heading padder-b-none"&gt;
    &lt;h2 class="h4 sp-attachments-header panel-title pull-left"&gt;
      ${Attachments}
    &lt;/h2&gt;
    &lt;div ng-if="::(data.canWrite &amp;&amp; data.canAttach)"&gt;
      &lt;sp-attachment-button&gt;&lt;/sp-attachment-button&gt;
    &lt;/div&gt;
    &lt;div class="clearfix"&gt;&lt;/div&gt;
  &lt;/div&gt;

  &lt;!-- small device - hide body unless there are attachments --&gt;
  &lt;div class="panel-body" ng-class="{'hidden-xs': !hasAttachments()}"&gt;
    &lt;div ng-if="data.canWrite &amp;&amp; data.canAttach" ng-file-drop="dropFiles($files)" ng-multiple="true" class="sp-attachments"&gt;
      &lt;div ng-if="::data.canDragAndDrop" class="sp-no-attachments text-center text-italic text-muted" ng-show="!hasAttachments()"&gt;
        &lt;em class="sp-drop-area"&gt;${Drop files here}&lt;/em&gt;
      &lt;/div&gt;
      &lt;div ng-if="::!data.canDragAndDrop" class="sp-no-attachments text-center text-muted" ng-show="!hasAttachments()"&gt;
        &lt;em&gt;{{::data.noAttachmentsMsg}}&lt;/em&gt;
      &lt;/div&gt;
      &lt;now-attachments-list template="sp_attachment" /&gt;
    &lt;/div&gt;

    &lt;div ng-if="!data.canWrite || !data.canAttach" class="sp-attachments"&gt;
      &lt;div class="sp-no-attachments text-center text-muted" ng-show="!hasAttachments()"&gt;
        &lt;em&gt;{{::data.noAttachmentsMsg}}&lt;/em&gt;
      &lt;/div&gt;
      &lt;now-attachments-list template="sp_attachment" /&gt;
    &lt;/div&gt;
  &lt;/div&gt;

  &lt;!-- no attachments msg at phone size when can't write --&gt;
  &lt;div class="panel-body visible-xs-block" ng-if="!hasAttachments() &amp;&amp; (!data.canWrite || !data.canAttach)"&gt;
    &lt;div class="sp-no-attachments text-center text-muted"&gt;
      &lt;em&gt;{{::data.noAttachmentsMsg}}&lt;/em&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;]]&gt;&lt;/template&gt;&lt;/sp_widget&gt;</payload><sys_class_name>sp_rel_widget_clone</sys_class_name><sys_created_by>mateus.anzolin</sys_created_by><sys_created_on>2021-01-29 19:49:27</sys_created_on><sys_id>dd74704d070220107a0af0269c1ed0c5</sys_id><sys_mod_count>0</sys_mod_count><sys_name>dd74704d070220107a0af0269c1ed0bf</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sp_rel_widget_clone_dd74704d070220107a0af0269c1ed0c5</sys_update_name><sys_updated_by>mateus.anzolin</sys_updated_by><sys_updated_on>2021-01-29 19:49:27</sys_updated_on></sp_rel_widget_clone></record_update>]]></payload>
<payload_hash>1877008609</payload_hash>
<remote_update_set display_value="ACN: Page - Tickets">bb26919607c220107a0af0269c1ed0dd</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>mateus.anzolin</sys_created_by>
<sys_created_on>2021-02-02 19:29:13</sys_created_on>
<sys_id>7326919607c220107a0af0269c1ed0e0</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>1774fb17be60000001</sys_recorded_at>
<sys_updated_by>mateus.anzolin</sys_updated_by>
<sys_updated_on>2021-02-02 19:29:13</sys_updated_on>
<table/>
<target_name>dd74704d070220107a0af0269c1ed0bf</target_name>
<type>Widget Clone</type>
<update_domain>global</update_domain>
<update_guid>d974704d7002201027c72d9c222c54c7</update_guid>
<update_guid_history>d974704d7002201027c72d9c222c54c7:1877008609</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sp_instance_2193b80d070220107a0af0269c1ed0fe</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_instance"><sp_instance action="INSERT_OR_UPDATE"><active>true</active><class_name/><color>default</color><css/><glyph/><id/><order>1</order><roles/><short_description/><size>md</size><sp_column display_value="1">5e83f80d070220107a0af0269c1ed0aa</sp_column><sp_widget display_value="ACN Ticket Conversations">556520f21b796050c7bbea8ce54bcb2b</sp_widget><sys_class_name>sp_instance</sys_class_name><sys_created_by>mateus.anzolin</sys_created_by><sys_created_on>2021-01-29 19:45:38</sys_created_on><sys_id>2193b80d070220107a0af0269c1ed0fe</sys_id><sys_mod_count>0</sys_mod_count><sys_name/><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sp_instance_2193b80d070220107a0af0269c1ed0fe</sys_update_name><sys_updated_by>mateus.anzolin</sys_updated_by><sys_updated_on>2021-01-29 19:45:38</sys_updated_on><title/><url/><widget_parameters/></sp_instance><sys_translated_text action="delete_multiple" query="documentkey=2193b80d070220107a0af0269c1ed0fe"/></record_update>]]></payload>
<payload_hash>-1741387624</payload_hash>
<remote_update_set display_value="ACN: Page - Tickets">bb26919607c220107a0af0269c1ed0dd</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>mateus.anzolin</sys_created_by>
<sys_created_on>2021-02-02 19:29:13</sys_created_on>
<sys_id>7726919607c220107a0af0269c1ed0df</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>1774fadfdcf0000001</sys_recorded_at>
<sys_updated_by>mateus.anzolin</sys_updated_by>
<sys_updated_on>2021-02-02 19:29:13</sys_updated_on>
<table/>
<target_name/>
<type>Instance</type>
<update_domain>global</update_domain>
<update_guid>e193f80d67022010f7b57b0f40648800</update_guid>
<update_guid_history>e193f80d67022010f7b57b0f40648800:-1741387624</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>m2m_sp_widget_dependency_1d74704d070220107a0af0269c1ed0c2</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="m2m_sp_widget_dependency"><m2m_sp_widget_dependency action="INSERT_OR_UPDATE"><sp_dependency display_value="dialog-polyfill">2eaf31f30b301200b0b02c6317673a84</sp_dependency><sp_widget display_value="Copy of Ticket Attachments">dd74704d070220107a0af0269c1ed0bf</sp_widget><sys_class_name>m2m_sp_widget_dependency</sys_class_name><sys_created_by>mateus.anzolin</sys_created_by><sys_created_on>2021-01-29 19:49:27</sys_created_on><sys_id>1d74704d070220107a0af0269c1ed0c2</sys_id><sys_mod_count>0</sys_mod_count><sys_name>dialog-polyfill.Copy of Ticket Attachments</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>m2m_sp_widget_dependency_1d74704d070220107a0af0269c1ed0c2</sys_update_name><sys_updated_by>mateus.anzolin</sys_updated_by><sys_updated_on>2021-01-29 19:49:27</sys_updated_on></m2m_sp_widget_dependency></record_update>]]></payload>
<payload_hash>729175814</payload_hash>
<remote_update_set display_value="ACN: Page - Tickets">bb26919607c220107a0af0269c1ed0dd</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>mateus.anzolin</sys_created_by>
<sys_created_on>2021-02-02 19:29:12</sys_created_on>
<sys_id>7b26919607c220107a0af0269c1ed0de</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>1774fb17b8a0000001</sys_recorded_at>
<sys_updated_by>mateus.anzolin</sys_updated_by>
<sys_updated_on>2021-02-02 19:29:12</sys_updated_on>
<table/>
<target_name>dialog-polyfill.Copy of Ticket Attachments</target_name>
<type>Widget Dependency</type>
<update_domain>global</update_domain>
<update_guid>1d74704d6f02201007425c2c197127c4</update_guid>
<update_guid_history>1d74704d6f02201007425c2c197127c4:729175814</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sp_widget_84b2b057db5680504e5f32ffaa961982</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sp_widget"&gt;&lt;sp_widget action="INSERT_OR_UPDATE"&gt;&lt;category&gt;custom&lt;/category&gt;&lt;client_script&gt;&lt;![CDATA[function() {
  var c = this;
	
	c.color = function(state,index){
		 return ((state.order &gt; c.data.active_order) || ((c.data.state.length - index) == 2) || !c.data.show);
	}
}]]&gt;&lt;/client_script&gt;&lt;controller_as&gt;c&lt;/controller_as&gt;&lt;css&gt;.flow{
  padding-bottom: 15px;
}

.steps{
  list-style: none;
  padding: 0px;
  margin: 0px;
  width: 100%;
  display: flex;
  justify-content: space-between;

}

.steps__item{
  display: inline-block;
  font-style: normal;
  font-weight: normal;
  font-size: 11px;
  line-height: 16px;
  position:relative;
  width: 25%;

  p{
    margin-bottom: 0px;
    text-align: center;
  }
}

.icons{
  position:relative;
  text-align: center;
  border-radius: 25px;
  width: 26px;
  height: 26px;
  margin: auto;
  margin-bottom: 5px;
  padding-top: 5px;
  color: white;
  font-size: 16px;
  display: block;
  z-index: 2;
  font-style: normal;
}

.icons::before{
  position: relative;
}

.steps__item::after{
  content: " ";
  position: absolute;
  top: 26%;
  width: 100%;
  left: 50%;
  height: 2px;
  z-index: 0;
}

.pink_line{
  &amp;amp;::after{
    background-color: $brand-primary;
  }
}

.grey_line{
  &amp;amp;::after{
    background-color: #BBAEA6;
  }
}

.steps__item:last-child{
  &amp;amp;::after{
    display: none;
  }
}

.nextStep{
  background-color: #BBAEA6;

  span{
    z-index: 2;
    position: relative;
  }
}

.previousStep, .actualStep{
  background-color: $brand-primary;
}

@media screen and (max-width: 992px) and (min-width: 768px){
  .steps__item::after{
    top: 20%;

  }
} 

@media screen and (max-width: 657px){
  .steps__item::after{
    top: 20%;
  }
} 

@media screen and (max-width: 455px){
  .steps__item p{
    font-size: 10px;
  }
} 











&lt;/css&gt;&lt;data_table&gt;sp_instance&lt;/data_table&gt;&lt;demo_data/&gt;&lt;description/&gt;&lt;docs/&gt;&lt;field_list/&gt;&lt;has_preview&gt;false&lt;/has_preview&gt;&lt;id&gt;acn_proccess_flow&lt;/id&gt;&lt;internal&gt;false&lt;/internal&gt;&lt;link&gt;&lt;![CDATA[function link(scope, element, attrs, controller) {  }]]&gt;&lt;/link&gt;&lt;name&gt;ACN Proccess Flow&lt;/name&gt;&lt;option_schema&gt;[]&lt;/option_schema&gt;&lt;public&gt;false&lt;/public&gt;&lt;roles/&gt;&lt;script&gt;&lt;![CDATA[(function() {
	/* populate the 'data' object */
	/* e.g., data.table = $sp.getValue('table'); */

	options.table = $sp.getParameter("table");
	options.record = $sp.getParameter("sys_id");

	var gr = new GlideRecord(options.table);
	gr.get(options.record)
	data.currentTable = '';
	data.atualKey = '';
	data.canRead = gr.canRead();

	var fields = $sp.getField(gr, 'stage');
	data.flow = createProcessFlow();

	// Check the process flow query against the current job to see if the conditions match

	function getCurrentSteps(step, table, id) {

		var gnr = new GlideRecord(table);
		gnr.addEncodedQuery(step);
		gnr.addQuery('sys_id', id);
		gnr.query();
		if (gnr.next()) 
			return 'warning';
		else 
			return 'primary';
	}

	// Set the previous steps in the flow to success if the current step is further down the order
	function ActiveSuccess(items) {
		var i = 0;
		for (var key in items) {
			var value = items[key];

			data.atualKey = key;
			if (value.colour == 'warning') {
				var index = i;
				for (var j = 0; j&lt;i; j++) {
					items[j].colour = 'success';
				}
				if (index == items.length) {
					value.colour = 'sucess';
				}
				break;
			}
			i++;
		}

		return items;
	}


	function createProcessFlow() {

		var table = gr.getTableName();
		var id = gr.getUniqueValue();

		var gf = new GlideRecord('sys_process_flow');
		gf.addActiveQuery();
		gf.addQuery('table', table);
		gf.orderBy('order');
		gf.query();

		data.currentTable = table;
		var items = [];

		var count = 0;

		while (gf.next()) {

			count++;

			var item = {};
			item.name = gs.getMessage(gf.getDisplayValue("label"));
			item.colour = getCurrentSteps(gf.condition.toString(), table, id);
			item.number = count;
			item.stage = gr.getValue('stage');
			items.push(item);

		}

		items = ActiveSuccess(items);
		return items;

	}

})();]]&gt;&lt;/script&gt;&lt;servicenow&gt;false&lt;/servicenow&gt;&lt;sys_class_name&gt;sp_widget&lt;/sys_class_name&gt;&lt;sys_created_by&gt;organize.gabriella&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2020-01-17 13:21:27&lt;/sys_created_on&gt;&lt;sys_id&gt;84b2b057db5680504e5f32ffaa961982&lt;/sys_id&gt;&lt;sys_mod_count&gt;258&lt;/sys_mod_count&gt;&lt;sys_name&gt;ACN Proccess Flow&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sp_widget_84b2b057db5680504e5f32ffaa961982&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;mateus.anzolin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2021-02-02 19:18:09&lt;/sys_updated_on&gt;&lt;template&gt;&lt;![CDATA[&lt;div class="flow"&gt;
  &lt;ul class="steps"&gt;
    &lt;li ng-repeat="key in data.flow" class="steps__item" ng-class="{'grey_line': key.colour != 'success', 'pink_line': key.colour == 'success'}"&gt;
      &lt;i 
         ng-if="key.colour == 'success'" 
         class="icon-check previousStep icons"
         aria-hidden="true"&gt;
      &lt;/i&gt;
      &lt;i 
         ng-if="key.colour == 'warning'" 
         class="icon-check actualStep icons"
         aria-hidden="true"&gt;
      &lt;/i&gt;
      &lt;i 
         class="nextStep icons"
         ng-if="key.colour != 'success' &amp;&amp; key.colour != 'warning'"
         aria-hidden="true"&gt;
        &lt;span&gt;{{key.number}}&lt;/span&gt;
      &lt;/i&gt;
      &lt;p&gt;
        {{key.name}}
      &lt;/p&gt;        
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/div&gt;]]&gt;&lt;/template&gt;&lt;/sp_widget&gt;&lt;/record_update&gt;</payload>
<payload_hash>-1054739887</payload_hash>
<remote_update_set display_value="ACN: Page - Tickets">bb26919607c220107a0af0269c1ed0dd</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>mateus.anzolin</sys_created_by>
<sys_created_on>2021-02-02 19:29:13</sys_created_on>
<sys_id>7f26919607c220107a0af0269c1ed0e0</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>177642e44130000001</sys_recorded_at>
<sys_updated_by>mateus.anzolin</sys_updated_by>
<sys_updated_on>2021-02-02 19:29:13</sys_updated_on>
<table/>
<target_name>ACN Proccess Flow</target_name>
<type>Widget</type>
<update_domain>global</update_domain>
<update_guid>79a3ddd208c220104f2063aaed693b01</update_guid>
<update_guid_history>79a3ddd208c220104f2063aaed693b01:-1054739887,65c2700dfe022010825279ebc6399e48:-1280503919</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sp_container_d773740d070220107a0af0269c1ed0e4</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_container"><sp_container action="INSERT_OR_UPDATE"><background_color/><background_image/><background_style>default</background_style><bootstrap_alt>false</bootstrap_alt><class_name/><container_class_name/><name>ACN Tickets - Container 1</name><order>1</order><sp_page display_value="acn_ticket">1c33f40d070220107a0af0269c1ed033</sp_page><subheader>false</subheader><sys_class_name>sp_container</sys_class_name><sys_created_by>mateus.anzolin</sys_created_by><sys_created_on>2021-01-29 19:45:13</sys_created_on><sys_id>d773740d070220107a0af0269c1ed0e4</sys_id><sys_mod_count>0</sys_mod_count><sys_name>ACN Tickets - Container 1</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sp_container_d773740d070220107a0af0269c1ed0e4</sys_update_name><sys_updated_by>mateus.anzolin</sys_updated_by><sys_updated_on>2021-01-29 19:45:13</sys_updated_on><title/><width>container</width></sp_container></record_update>]]></payload>
<payload_hash>1825580299</payload_hash>
<remote_update_set display_value="ACN: Page - Tickets">bb26919607c220107a0af0269c1ed0dd</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>mateus.anzolin</sys_created_by>
<sys_created_on>2021-02-02 19:29:13</sys_created_on>
<sys_id>b326919607c220107a0af0269c1ed0df</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>1774fad9a450000001</sys_recorded_at>
<sys_updated_by>mateus.anzolin</sys_updated_by>
<sys_updated_on>2021-02-02 19:29:13</sys_updated_on>
<table/>
<target_name>ACN Tickets - Container 1</target_name>
<type>Container</type>
<update_domain>global</update_domain>
<update_guid>1b73740dcf022010a54f1f6e5c1e1ee6</update_guid>
<update_guid_history>1b73740dcf022010a54f1f6e5c1e1ee6:1825580299</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>db_image_c7f7f401074220107a0af0269c1ed0bc</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="db_image"><db_image action="INSERT_OR_UPDATE"><active>true</active><category>Service Portal</category><format/><height/><image>f8287001074220107a0af0269c1ed0e8</image><name>accept-icon.svg</name><size_bytes>723</size_bytes><sys_class_name>db_image</sys_class_name><sys_created_by>mateus.anzolin</sys_created_by><sys_created_on>2021-01-29 20:05:18</sys_created_on><sys_id>c7f7f401074220107a0af0269c1ed0bc</sys_id><sys_mod_count>2</sys_mod_count><sys_name>accept-icon.svg</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>db_image_c7f7f401074220107a0af0269c1ed0bc</sys_update_name><sys_updated_by>mateus.anzolin</sys_updated_by><sys_updated_on>2021-01-29 20:05:32</sys_updated_on><thumbnail/><width/></db_image><sys_attachment action="INSERT_OR_UPDATE"><average_image_color/><chunk_size_bytes>700000</chunk_size_bytes><compressed>true</compressed><content_type>image/svg+xml</content_type><file_name>image</file_name><hash>be1c1d8e672a0fc697573be4b8ee466a5da54bdebf3254a19696a38e1afa4244</hash><image_height/><image_width/><size_bytes>723</size_bytes><size_compressed>412</size_compressed><state>pending</state><sys_created_by>mateus.anzolin</sys_created_by><sys_created_on>2021-01-29 20:05:32</sys_created_on><sys_id>f8287001074220107a0af0269c1ed0e8</sys_id><sys_mod_count>2</sys_mod_count><sys_updated_by>mateus.anzolin</sys_updated_by><sys_updated_on>2021-01-29 20:05:32</sys_updated_on><table_name>ZZ_YYdb_image</table_name><table_sys_id>c7f7f401074220107a0af0269c1ed0bc</table_sys_id></sys_attachment><sys_attachment_doc action="INSERT_OR_UPDATE"><data>H4sIAAAAAAAAAA==</data><length>16</length><position>0</position><sys_attachment display_value="image" sys_id="f8287001074220107a0af0269c1ed0e8">f8287001074220107a0af0269c1ed0e8</sys_attachment><sys_created_by>mateus.anzolin</sys_created_by><sys_created_on>2021-01-29 20:05:32</sys_created_on><sys_id>3c287001074220107a0af0269c1ed0e8</sys_id></sys_attachment_doc><sys_attachment_doc action="INSERT_OR_UPDATE"><data>tZLLbtswEEX3+QqC+47mQQ45RZRFtU233Qe1ail1JcNWo3x+hy5coOi6gIDRvSTvHD4er2/HsM+HbeojYwzTOB+nzf8phrd53D+t733EgIH9c+/bfDr1cVmXMYb3H6fl2sdp284fu27fd9gF1suxY0TsPDg+PTyeX7YpHPr4mSqICAeD4vULIeTh5jEFYmArgQqUjBIoAaacAyloSa4zpJrq4DVbleYbJ7rNq9naOiulpYiyBk9NVXXwFiqWmjZTChWKlRbrWpKFAkRkTQoxDd6ElVNL0+rLBKwWvFFkqU0j1kaZAQVt4FaqrxfILE4FWbVVguIpHpJy8e1aUhsIKnJtDJTFWRmSs1BQSD5MHq6asQTPrlh1SFCFVdwvlCq3eYTOzFCUi7Uc7yWhbVmLDt6GlBzOTwLLb4iM5OOUybhBilF2XatIDNftsn4f+7hP8zbe5Yf7Q/hjnOZl/Ppy7uNl/bkc/rJf13m5+92/F93QvRPnZ8J2M1SSPRfIfiB+p8b/A6G9uaeHX8Oem4zTAgAA</data><length>536</length><position>1</position><sys_attachment display_value="image" sys_id="f8287001074220107a0af0269c1ed0e8">f8287001074220107a0af0269c1ed0e8</sys_attachment><sys_created_by>mateus.anzolin</sys_created_by><sys_created_on>2021-01-29 20:05:32</sys_created_on><sys_id>bc287001074220107a0af0269c1ed0e8</sys_id></sys_attachment_doc></record_update>]]></payload>
<payload_hash>1978161209</payload_hash>
<remote_update_set display_value="ACN: Page - Tickets">bb26919607c220107a0af0269c1ed0dd</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>mateus.anzolin</sys_created_by>
<sys_created_on>2021-02-02 19:29:12</sys_created_on>
<sys_id>b726919607c220107a0af0269c1ed0de</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>1774fc034cb0000001</sys_recorded_at>
<sys_updated_by>mateus.anzolin</sys_updated_by>
<sys_updated_on>2021-02-02 19:29:12</sys_updated_on>
<table/>
<target_name>accept-icon.svg</target_name>
<type>Images</type>
<update_domain>global</update_domain>
<update_guid>c5287801ef4220109f64c7306e13b4d1</update_guid>
<update_guid_history>c5287801ef4220109f64c7306e13b4d1:1978161209,f8287801d0422010e4961a5861050cce:-437457220,b0287001f2422010ab858c4dfa9d61ed:-784438838,a91830010642201027342b5ba70eb464:-1877926355</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sp_widget_694f287e1b796050c7bbea8ce54bcb0b</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sp_widget"&gt;&lt;sp_widget action="INSERT_OR_UPDATE"&gt;&lt;category&gt;custom&lt;/category&gt;&lt;client_script&gt;&lt;![CDATA[function ($scope, spUtil) {
  $scope.$on('record.updated', function(name, data) {
    spUtil.update($scope);
  });
}]]&gt;&lt;/client_script&gt;&lt;controller_as&gt;c&lt;/controller_as&gt;&lt;css&gt;.more-options{
  color: $magenta;
  font-size: 16px;
  font-family: 'Pluto';
}

.panel-body{
  padding:15px 27px;
}

.field {
  display: flex;
  justify-content: space-between;
  padding-bottom: 5px;
  border-bottom: 1px solid #E5E5E5;
  
  div{
  	font-weight: 500;
    margin-left: 10px;
  }
}

.opt__icon{
 	font-size: 10px; 
  vertical-align: 2px 
}&lt;/css&gt;&lt;data_table&gt;sp_instance&lt;/data_table&gt;&lt;demo_data/&gt;&lt;description/&gt;&lt;docs/&gt;&lt;field_list/&gt;&lt;has_preview&gt;false&lt;/has_preview&gt;&lt;id&gt;acn_ticket_fiels&lt;/id&gt;&lt;internal&gt;false&lt;/internal&gt;&lt;link&gt;&lt;![CDATA[function link(scope, element, attrs, controller) {  }]]&gt;&lt;/link&gt;&lt;name&gt;ACN Ticket Fiels&lt;/name&gt;&lt;option_schema&gt;[
   {
      "name": "pickup_msg",
      "label": "Pickup message",
      "type": "string"
   }
]&lt;/option_schema&gt;&lt;public&gt;false&lt;/public&gt;&lt;roles/&gt;&lt;script&gt;&lt;![CDATA[(function(){

	data.pickupMsg = gs.getMessage(options.pickup_msg);
	
	//VALIDATION ------------------
	var gr = $sp.getRecord();
	data.canRead = gr.canRead();
	if (!data.canRead) 
		return;

	var agent = "";
	var a = $sp.getField(gr, 'assigned_to');
	if (a != null)
		agent = a.display_value;

	//GET FIELDS ------------------
	var first_fields = [];
	if (gr.getValue('caller_id') != '' &amp;&amp; gr.getTableName() == 'incident' ){
		var caller_id = $sp.getField(gr, 'caller_id');
		caller_id.column_name = 'caller_id';
		first_fields.push(caller_id);
	}

	if (gr.getTableName() == 'sc_req_item' &amp;&amp; gr.getValue('request') != ''){
		var grReq = new GlideRecord('sc_request');
		grReq.get(gr.getValue('request'));
		if(grReq.isValidRecord()){
			var requested_for = $sp.getField(grReq, 'requested_for');
			requested_for.column_name = 'requested_for';
			first_fields.push(requested_for);
		}
	}

	var fields = $sp.getFields(gr, 'number,state,priority,sys_created_on');
	if (gr.getValue("sys_mod_count") &gt; 0)
		fields.push($sp.getField(gr, 'sys_updated_on'));

	if (gr.getValue('price') &gt; 0)
		fields.push($sp.getField(gr, 'price'));

	if (gr.getValue('recurring_price') &gt; 0) {
		var rp = $sp.getField(gr, 'recurring_price');
		if (gr.isValidField("recurring_price"))
			rp.display_value = rp.display_value + " " + gr.getDisplayValue("recurring_frequency");
		fields.push(rp);
	}

	if (gr.getValue('due_date') != '' &amp;&amp; gr.getTableName() == 'incident' ){
		var due_date = $sp.getField(gr, 'due_date');
		due_date.column_name = 'due_date';
		fields.push(due_date);
	}

	if (gr.getValue('due_date') != '' &amp;&amp; gr.getTableName() == 'sc_req_item' ){
		var due_date_req = $sp.getField(gr, 'due_date');
		fields.push(due_date_req);
	}


	if (gr.getValue('estimated_delivery') != '' &amp;&amp; gr.getTableName() == 'sc_req_item' ){
		var estimated_devlivery = $sp.getField(gr,'estimated_delivery');
		estimated_devlivery.column_name = 'estimated_delivery';
		fields.push(estimated_devlivery);
	}

	//GET APPROVERS ------------------
	var stage = gr.getValue('stage');
	if(stage != 'pending' &amp;&amp; gr.getTableName() == 'sc_req_item' &amp;&amp; !gs.nil(stage)){
		var grAp = new GlideRecord('sysapproval_approver');
		grAp.addQuery('document_id',gr.getUniqueValue());
		grAp.query();

		var list = [], isFirst = true;
		while(grAp.next()){
			if(isFirst){
				var approver = $sp.getField(grAp,'approver');
				approver.column_name = 'approver';
				fields.push(approver);
				isFirst = false;
			}
			list.push(grAp.getDisplayValue('approver'));
		}
		list = list.join(",");
		if(!gs.nil(approver))
			approver.display_value = list;
	}

	fields  = first_fields.concat(fields);
	
	function translateVariables(variableValue, language){
		var gr = new GlideRecord('sys_translated');
		gr.addQuery('value',variableValue);
		gr.addQuery('language', language);
		gr.query();

		if(gr.next()){
			return gr.label.toString();
		}
		return variableValue;
	}

	data.tableLabel = gr.getLabel();
	data.fields = fields;
	data.variables = $sp.getVariablesArray();
	var myUserObject = gs.getUser();
	var language = myUserObject.getLanguage().toString();

	for(var i = 0; i&lt;data.variables.length; i++){
		data.variables[i].display_value = translateVariables(data.variables[i].display_value, language);
	}

	data.agent = agent;
	data.agentPossible = gr.isValidField("assigned_to");
	data.table = gr.getTableName();
	data.sys_id = gr.getUniqueValue();
})()

]]&gt;&lt;/script&gt;&lt;servicenow&gt;false&lt;/servicenow&gt;&lt;sys_class_name&gt;sp_widget&lt;/sys_class_name&gt;&lt;sys_created_by&gt;Anna.Organize&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2021-01-22 19:40:28&lt;/sys_created_on&gt;&lt;sys_id&gt;694f287e1b796050c7bbea8ce54bcb0b&lt;/sys_id&gt;&lt;sys_mod_count&gt;58&lt;/sys_mod_count&gt;&lt;sys_name&gt;ACN Ticket Fiels&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sp_widget_694f287e1b796050c7bbea8ce54bcb0b&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;mateus.anzolin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2021-02-02 19:18:40&lt;/sys_updated_on&gt;&lt;template&gt;&lt;![CDATA[&lt;div ng-if="data.canRead" class="panel b"&gt;
  &lt;div class="panel-body"&gt;
    &lt;widget id="acn_accept_or_reject"&gt;&lt;/widget&gt;
    &lt;div ng-if="data.fields.length &gt; 0"&gt;
      &lt;div class="row"&gt;
        &lt;div class="col-12 m-b field" ng-repeat="(fieldName, field) in data.fields" 
             ng-if="field.value &amp;&amp; (field.type != 'decimal' || field.type == 'decimal' &amp;&amp; field.value != 0)" &gt;
          &lt;label class="m-n"&gt;{{field.label}}&lt;/label&gt;
          &lt;span ng-switch="field.type" ng-if="field.column_name != 'estimated_delivery' &amp;&amp; field.column_name != 'due_date' "&gt; 

            &lt;div ng-switch-when="glide_date_time" title="{{field.display_value}}"&gt;
              &lt;sn-time-ago timestamp="::field.value" /&gt;
            &lt;/div&gt;
            &lt;div ng-switch-default &gt;{{field.display_value}}&lt;/div&gt;
          &lt;/span&gt;
          &lt;span ng-if="field.column_name == 'estimated_delivery'"&gt;{{field.display_value}}&lt;/span&gt;
          &lt;span ng-if="field.column_name == 'due_date'"&gt;{{field.display_value}}&lt;/span&gt;

        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;

    &lt;div ng-if="data.variables.length &gt; 0" ng-init="variable_toggle=false"&gt;
      &lt;h4 ng-click="variable_toggle = !variable_toggle" style="cursor: pointer;" class="more-options"&gt;
        &lt;span class="glyphicon opt__icon" 
              ng-class="{'glyphicon-plus': !variable_toggle, 'glyphicon-minus': variable_toggle}"&gt;&lt;/span&gt;
        ${Options}
      &lt;/h4&gt;

      &lt;div ng-if="variable_toggle"&gt;
        &lt;hr&gt;
        &lt;div class="m-b break-word" ng-repeat="variable in data.variables" ng-if="variable.value != 'true'"&gt;
          &lt;label class="m-n"&gt;&lt;b&gt;{{variable.label}}&lt;/b&gt;&lt;/label&gt;
          &lt;div ng-if="variable.value != 'true' &amp;&amp; variable.value != 'false' "&gt;{{variable.display_value}}&lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;

  &lt;div ng-if="data.agentPossible &amp;&amp; !data.agent &amp;&amp; options.pickup_msg" class="panel-footer"&gt;
    &lt;div id="ticket_fields_footer" class="text-center text-muted" style="font-style: italic;" ng-bind-html="data.pickupMsg"&gt;
    &lt;/div&gt;
  &lt;/div&gt;

&lt;/div&gt;]]&gt;&lt;/template&gt;&lt;/sp_widget&gt;&lt;/record_update&gt;</payload>
<payload_hash>-563981323</payload_hash>
<remote_update_set display_value="ACN: Page - Tickets">bb26919607c220107a0af0269c1ed0dd</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>mateus.anzolin</sys_created_by>
<sys_created_on>2021-02-02 19:29:13</sys_created_on>
<sys_id>bb26919607c220107a0af0269c1ed0e0</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>177642ebbba0000001</sys_recorded_at>
<sys_updated_by>mateus.anzolin</sys_updated_by>
<sys_updated_on>2021-02-02 19:29:13</sys_updated_on>
<table/>
<target_name>ACN Ticket Fiels</target_name>
<type>Widget</type>
<update_domain>global</update_domain>
<update_guid>1dc3dd56cac22010eb7dca053157a8ad</update_guid>
<update_guid_history>1dc3dd56cac22010eb7dca053157a8ad:-563981323,88b3d99243c2201010be33408745ada3:-1396765198,a714cd5a8a822010cdaabe71970b6c2b:-438418140,07d345daa88220102355c925507d2f64:480927892,2f57700147422010b7469b417167105a:1760595325,ca14740ded022010d488a23eab9b2916:357411371</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sp_page_1c33f40d070220107a0af0269c1ed033</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_page"><sp_page action="INSERT_OR_UPDATE"><category>custom</category><css/><draft>false</draft><dynamic_title_structure>Tickets</dynamic_title_structure><id>acn_ticket</id><internal>false</internal><public>false</public><roles/><seo_script/><short_description/><sys_class_name>sp_page</sys_class_name><sys_created_by>mateus.anzolin</sys_created_by><sys_created_on>2021-01-29 19:44:55</sys_created_on><sys_id>1c33f40d070220107a0af0269c1ed033</sys_id><sys_mod_count>0</sys_mod_count><sys_name>acn_ticket</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sp_page_1c33f40d070220107a0af0269c1ed033</sys_update_name><sys_updated_by>mateus.anzolin</sys_updated_by><sys_updated_on>2021-01-29 19:44:55</sys_updated_on><title>ACN Tickets</title><use_seo_script>false</use_seo_script></sp_page><sys_translated_text action="delete_multiple" query="documentkey=1c33f40d070220107a0af0269c1ed033"/></record_update>]]></payload>
<payload_hash>298611116</payload_hash>
<remote_update_set display_value="ACN: Page - Tickets">bb26919607c220107a0af0269c1ed0dd</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>mateus.anzolin</sys_created_by>
<sys_created_on>2021-02-02 19:29:13</sys_created_on>
<sys_id>bf26919607c220107a0af0269c1ed0df</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>1774fad549f0000001</sys_recorded_at>
<sys_updated_by>mateus.anzolin</sys_updated_by>
<sys_updated_on>2021-02-02 19:29:13</sys_updated_on>
<table/>
<target_name>acn_ticket</target_name>
<type>Page</type>
<update_domain>global</update_domain>
<update_guid>4f63b40d6b022010295a9fe43ae5cccd</update_guid>
<update_guid_history>4f63b40d6b022010295a9fe43ae5cccd:298611116</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sp_widget_dd74704d070220107a0af0269c1ed0bf</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sp_widget"&gt;&lt;sp_widget action="INSERT_OR_UPDATE"&gt;&lt;category&gt;standard&lt;/category&gt;&lt;client_script&gt;&lt;![CDATA[function attachMate($scope, nowAttachmentHandler, $rootScope, spUtil, spModal, $log, spAriaUtil,$document) {
	$scope.errorMessages = [];
	$scope.attachmentHandler = new nowAttachmentHandler(setAttachments, appendError);
	$scope.data.action = "";

	spUtil.recordWatch($scope, "sys_attachment", "table_sys_id=" + $scope.data.sys_id, function(response, data) {
		$scope.attachmentHandler.getAttachmentList();
		if (response.data) {
			var options = {};
			options.operation = response.data.operation;
			options.filename = response.data.display_value;
			options.sys_id = $scope.data.sys_id;
			options.table = $scope.data.table; 
			options.state = (response.data.record &amp;&amp; response.data.record.state) ? response.data.record.state.value : "";
			//broadcast only if operation is update...we don't need insert and other record updates for now
			if (options.operation === "update" &amp;&amp; options.state === "not_available")
			$rootScope.$broadcast("attachment.updated",options);
		}
	});

	$scope.$evalAsync(function() {
		$scope.attachmentHandler.setParams($scope.data.table, $scope.data.sys_id, 1024 * 1024 * $scope.data.maxAttachmentSize);
		$scope.attachmentHandler.getAttachmentList();
	});

	$scope.hasAttachments = function() {
		return $scope.attachments &amp;&amp; $scope.attachments.length != 0;
	};

	$scope.canWrite = function() {
		return $scope.data.canWrite;
	};

	$scope.dropFiles = function(files) {
		if (!$scope.data.canDragAndDrop) {
			spUtil.addInfoMessage(data.noDragDropMsg);
			return;
		}
		$scope.attachmentHandler.onFileSelect(files);
	}
	
	$scope.confirmDeleteAttachment = function(attachment) {
		var appendTo = $scope.data.appendToId ? $document.find('#'+$scope.data.appendToId) : null;
		spModal.confirm("${Delete Attachment?}",  appendTo).then(function() {
				$scope.attachmentHandler.deleteAttachment(attachment);
		});
	};

	$scope.$on('dialog.upload_too_large.show', function(e){
		$log.error($scope.data.largeAttachmentMsg);
		spUtil.addErrorMessage($scope.data.largeAttachmentMsg);
	});

	$scope.$on('added_attachment', function(evt) {
		$scope.data.action = "added";
		spUtil.update($scope);
	});
	
	$scope.$on('sn.attachment.scanned', function(evt) {
		$scope.attachmentHandler.getAttachmentList("list");
	});
	
	$scope.$on('sp.record.can_write', function(evt, answer) {
		$scope.data.canWrite = answer;
	});

	function appendError(error) {
		$scope.errorMessages.push(error);
		spUtil.addErrorMessage(error.msg + error.fileName);
	}

	function setAttachments(attachments, action) {
		if ($scope.submitting == true)
			return;

		$scope.attachments = attachments;
		if (!action)
			return;
		
		if (action === "added") {
			spAriaUtil.sendLiveMessage($scope.data.attachmentSuccessMsg);
		}

		$scope.data.action = action;
		spUtil.update($scope);
	}
}]]&gt;&lt;/client_script&gt;&lt;controller_as&gt;c&lt;/controller_as&gt;&lt;css&gt;.sp-drop-area {
  display: block;
  padding: 30px;
  width: 100%;
  border: 1px dashed $panel-default-border;
}&lt;/css&gt;&lt;data_table&gt;sp_instance&lt;/data_table&gt;&lt;demo_data/&gt;&lt;description/&gt;&lt;docs/&gt;&lt;field_list/&gt;&lt;has_preview&gt;false&lt;/has_preview&gt;&lt;id&gt;acn_ticket_attachments&lt;/id&gt;&lt;internal&gt;false&lt;/internal&gt;&lt;link&gt;&lt;![CDATA[function link(scope, element, attrs, controller) {  }]]&gt;&lt;/link&gt;&lt;name&gt;ACN Ticket Attachments&lt;/name&gt;&lt;option_schema&gt;[{"hint":"ID of referenced record","name":"record_id","section":"Data","label":"Record ID","type":"string"},{"hint":"Table name of referenced record","name":"record_table","section":"Data","label":"Record Table","type":"string"}]&lt;/option_schema&gt;&lt;public&gt;false&lt;/public&gt;&lt;roles&gt;snc_external,snc_internal&lt;/roles&gt;&lt;script&gt;&lt;![CDATA[(function() {
	data.sys_id = input.sys_id || options.record_id || $sp.getParameter("sys_id");
	data.table = input.table || options.record_table || $sp.getParameter("table");
	data.appendToId = options.appendToId;
	data.table = _getActualTable(data.table, data.sys_id);
	data.maxAttachmentSize = parseInt(gs.getProperty("com.glide.attachment.max_size", 1024));
	if (isNaN(data.maxAttachmentSize))
		data.maxAttachmentSize = 24;
	data.largeAttachmentMsg = gs.getMessage("Attached files must be smaller than {0} - please try again", "" + data.maxAttachmentSize + "MB");
	data.attachmentSuccessMsg = gs.getMessage("Attachment successfully uploaded");
	data.noDragDropMsg = gs.getMessage("Attachment drap-and-drop not enabled - use attachment button");
	data.noAttachmentsMsg = gs.getMessage("There are no attachments");
	
	if (!data.table || !data.sys_id)
		return;

	var gr = new GlideRecord(data.table);
	if (!gr.isValid())
		return;
	
	if (!gr.get(data.sys_id))
		return;

	if (input &amp;&amp; input.action == "deleted") {
		gr.comments = input.action + " an attachment";
		gr.update();
	}

	data.canWrite = gr.canWrite();
	data.canAttach = gs.hasRole(gs.getProperty("glide.attachment.role")) &amp;&amp; GlideTableDescriptor.get(data.table).getED().getAttribute("no_attachment") != "true";
	data.canRead = gr.canRead();
	data.canDragAndDrop = gs.getProperty('glide.ui.attachment_drag_and_drop', 'true') === 'true';

	function _getActualTable(table, id) {
		if (!table)
			return table;
		
		var rec = new GlideRecord(table);
		if (!rec.isValid())
			return table;
		
		if (rec.get(id) &amp;&amp; rec.getValue('sys_class_name')) {
			return rec.getValue('sys_class_name');
		}
		return table;
	}
})();]]&gt;&lt;/script&gt;&lt;servicenow&gt;false&lt;/servicenow&gt;&lt;sys_class_name&gt;sp_widget&lt;/sys_class_name&gt;&lt;sys_created_by&gt;mateus.anzolin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2021-01-29 19:49:27&lt;/sys_created_on&gt;&lt;sys_id&gt;dd74704d070220107a0af0269c1ed0bf&lt;/sys_id&gt;&lt;sys_mod_count&gt;1&lt;/sys_mod_count&gt;&lt;sys_name&gt;ACN Ticket Attachments&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sp_widget_dd74704d070220107a0af0269c1ed0bf&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;mateus.anzolin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2021-01-29 19:49:54&lt;/sys_updated_on&gt;&lt;template&gt;&lt;![CDATA[&lt;div ng-if="data.canRead" class="panel panel-{{options.color}} b"&gt;
  &lt;div class="panel-heading padder-b-none"&gt;
    &lt;h2 class="h4 sp-attachments-header panel-title pull-left"&gt;
      ${Attachments}
    &lt;/h2&gt;
    &lt;div ng-if="::(data.canWrite &amp;&amp; data.canAttach)"&gt;
      &lt;sp-attachment-button&gt;&lt;/sp-attachment-button&gt;
    &lt;/div&gt;
    &lt;div class="clearfix"&gt;&lt;/div&gt;
  &lt;/div&gt;

  &lt;!-- small device - hide body unless there are attachments --&gt;
  &lt;div class="panel-body" ng-class="{'hidden-xs': !hasAttachments()}"&gt;
    &lt;div ng-if="data.canWrite &amp;&amp; data.canAttach" ng-file-drop="dropFiles($files)" ng-multiple="true" class="sp-attachments"&gt;
      &lt;div ng-if="::data.canDragAndDrop" class="sp-no-attachments text-center text-italic text-muted" ng-show="!hasAttachments()"&gt;
        &lt;em class="sp-drop-area"&gt;${Drop files here}&lt;/em&gt;
      &lt;/div&gt;
      &lt;div ng-if="::!data.canDragAndDrop" class="sp-no-attachments text-center text-muted" ng-show="!hasAttachments()"&gt;
        &lt;em&gt;{{::data.noAttachmentsMsg}}&lt;/em&gt;
      &lt;/div&gt;
      &lt;now-attachments-list template="sp_attachment" /&gt;
    &lt;/div&gt;

    &lt;div ng-if="!data.canWrite || !data.canAttach" class="sp-attachments"&gt;
      &lt;div class="sp-no-attachments text-center text-muted" ng-show="!hasAttachments()"&gt;
        &lt;em&gt;{{::data.noAttachmentsMsg}}&lt;/em&gt;
      &lt;/div&gt;
      &lt;now-attachments-list template="sp_attachment" /&gt;
    &lt;/div&gt;
  &lt;/div&gt;

  &lt;!-- no attachments msg at phone size when can't write --&gt;
  &lt;div class="panel-body visible-xs-block" ng-if="!hasAttachments() &amp;&amp; (!data.canWrite || !data.canAttach)"&gt;
    &lt;div class="sp-no-attachments text-center text-muted"&gt;
      &lt;em&gt;{{::data.noAttachmentsMsg}}&lt;/em&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;]]&gt;&lt;/template&gt;&lt;/sp_widget&gt;&lt;/record_update&gt;</payload>
<payload_hash>-639794138</payload_hash>
<remote_update_set display_value="ACN: Page - Tickets">bb26919607c220107a0af0269c1ed0dd</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>mateus.anzolin</sys_created_by>
<sys_created_on>2021-02-02 19:29:13</sys_created_on>
<sys_id>f326919607c220107a0af0269c1ed0e1</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>1774fb1e6050000001</sys_recorded_at>
<sys_updated_by>mateus.anzolin</sys_updated_by>
<sys_updated_on>2021-02-02 19:29:13</sys_updated_on>
<table/>
<target_name>ACN Ticket Attachments</target_name>
<type>Widget</type>
<update_domain>global</update_domain>
<update_guid>0094384d4a02201098047541d0a4697b</update_guid>
<update_guid_history>0094384d4a02201098047541d0a4697b:-639794138,9d74704dcb02201093ce82bac221aec1:-1769197497</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sp_widget_556520f21b796050c7bbea8ce54bcb2b</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sp_widget"&gt;&lt;sp_widget action="INSERT_OR_UPDATE"&gt;&lt;category&gt;custom&lt;/category&gt;&lt;client_script&gt;&lt;![CDATA[function spTicketConversation($scope, nowAttachmentHandler, $animate, $rootScope, cabrillo, $timeout, snRecordWatcher, spUtil, spAriaUtil, $http, $window, snAttachmentHandler, i18n, dynamicTranslation) {
	$scope.showLocationIcon = false;
	$scope.msg = "";
	$scope.isNative = cabrillo.isNative();
	$scope.errorMessages = [];
	var existingEntries = {};
	var c = this;
	var skipNextRecordWatchUpdate = false;
	$scope.typing = [];
	if (!$scope.data.hasReadableJournalField &amp;&amp; !$scope.data.isNewRecord)
		console.warn("No readable journal field (comments, work notes, etc.) available in the stream for this record");
	if ($scope.page &amp;&amp; $scope.page.g_form)
		hideParentJournalFields();

	function hideParentJournalFields() {
		if (!$scope.data.stream)
			return;

		var fields = $scope.data.stream.journal_fields;
		var g_form = $scope.page.g_form;
		for (var f in fields)
			g_form.setDisplay(fields[f].name, false);
	}
	var liveProfiles = {};
	liveProfiles[$scope.user.sys_id] = {
		userID: $scope.user.sys_id,
		name: $scope.user.name,
		initials: $window.NOW.user_initials
	};
	if ($window.NOW.user_avatar) {
		liveProfiles[$scope.user.sys_id].userImage = $window.NOW.user_avatar;
	}

	$scope.getLiveProfileByUserId = function (userId){
		return liveProfiles[userId];
	}

	var pending = {};

	//Little caching implementation to make sure we only get a given user's profile once.
	$scope.hasLiveProfile = function hasLiveProfile(userId){
		if (!userId)
			return false;

		if (liveProfiles[userId])
			return true;
		
		if (pending[userId])
			return false;
		
		pending[userId] = $http.get('/api/now/live/profiles/sys_user.' + userId).then(function (response) {
			liveProfiles[userId] = {
				userID: userId,
				name: response.data.result.name,
				initials: buildInitials(response.data.result.name),
				avatar: response.data.result.avatar
			};
		});
		return false;
	}

	function buildInitials(name) {
		if (!name)
			return "--";

		var initials = name.split(" ").map(function(word) {
			return word.toUpperCase();
		}).filter(function(word) {
			return word.match(/^[A-Z]/);
		}).map(function(word) {
			return word.substring(0,1);
		}).join("");

		return (initials.length &gt; 3) ? initials.substr(0, 3) : initials;
	}


	function setupAttachmentHandler(){
		$scope.attachmentHandler = new nowAttachmentHandler(attachSuccess, appendError);

		function attachSuccess() {
			$rootScope.$broadcast("sp.attachments.update", $scope.data.sys_id);
			spAriaUtil.sendLiveMessage($scope.data.attachAddedMsg);
		}

		function appendError(error) {
			spUtil.addErrorMessage(error.msg + error.fileName);
			$scope.errorMessages.push(error);
			spAriaUtil.sendLiveMessage($scope.data.attachFailMsg);
		}

		$timeout(function() {
			$scope.attachmentHandler.setParams($scope.data.table, $scope.data.sys_id, 1024 * 1024 * $scope.data.maxAttachmentSize);
		})
	}
	setupAttachmentHandler();

	var recordWatcherTimer;
	$scope.$on('record.updated', function(name, data) {
		// Use record watcher update if:
		//	This record was updated AND This widget didn't trigger the update.
		if (data.table_name == $scope.data.table &amp;&amp; data.sys_id == $scope.data.sys_id){
			$timeout.cancel(recordWatcherTimer);
			recordWatcherTimer = $timeout(function(){
				if (skipNextRecordWatchUpdate)
					skipNextRecordWatchUpdate = false;
				else
					spUtil.update($scope).then(function(r){
						$scope.data.stream = r.stream;
					});
			}, 250);
		}
	});

	$scope.$on('sp.show_location_icon', function(evt) {
		$scope.data.showLocationIcon = true;
	});
	
	$scope.$on('attachment.updated', function(evt,options) {
		if ($scope.data.sys_id != -1 &amp;&amp; options.sys_id == $scope.data.sys_id)
			updateAttachmentState($scope.data.table, $scope.data.sys_id);
	});
	

	function updateAttachmentState(table, sys_id) {
			c.server.update().then(function (data) {
					if (!data.stream || !data.stream.entries)
						return;
					var newEntries = data.stream.entries;
					var currEntries = $scope.data.mergedEntries;
					var oldSize = currEntries ? currEntries.length : 0;
					var newSize = newEntries.length;
					for (var i = 0; i &lt; oldSize; i++) {
							if (!currEntries[i].attachment)
									continue;
							for (var j = 0; j &lt; newSize; j++) {
									if (currEntries[i].sys_id == newEntries[j].sys_id &amp;&amp; newEntries[j].attachment) {
											currEntries[i].attachment.state = newEntries[j].attachment.state;
											break;
									}
							}
					}
			});
	}
	
	$scope.scanAttachment = function(attachment){
		snAttachmentHandler.scanAttachment(attachment);
	}
	
	$rootScope.$on('sp.sessions', function(evt, sessions) {
		$scope.typing = [];
		Object.keys(sessions).forEach(function (session) {
			var journalFields = scope.data.stream.journal_fields;
			var canUserReadJournalField = false;
			session = sessions[session];
			
			for (var j = 0; j &lt; journalFields.length; j++) {
				if (journalFields[j].name === session.field_type) {
					canUserReadJournalField = journalFields[j].can_read;
					break;
				}									
			}
			
			if (session.status === 'typing' &amp;&amp; canUserReadJournalField)
				$scope.typing.push(session);
			else
				return;
	
		})
	})

	$scope.$on('sp.conversation_title.changed', function(evt, text) {
		$scope.data.ticketTitle = text;
	})

	$scope.$watch("data.canWrite", function() {
		$rootScope.$broadcast("sp.record.can_write", $scope.data.canWrite);
	});

	var streamUpdateTimer;
	$scope.$watch("data.stream", function() {
		$timeout.cancel(streamUpdateTimer);
		streamUpdateTimer = $timeout(function() {
			mergeStreamEntries();
		}, 50);
	});

	function mergeStreamEntries() {
		$scope.placeholder = $scope.data.placeholderNoEntries;
		if (!$scope.data.stream || !$scope.data.stream.entries)
			return;

		$scope.placeholder = $scope.data.placeholder;
		var entries = $scope.data.stream.entries;
		for (var i = 0; i &lt; entries.length; i++) {
		    if (entries[i].attachment)
		        entries[i].attachment = $scope.attachmentHandler.canViewImage([entries[i].attachment])[0];
		}
		if (!$scope.data.mergedEntries) {
			$scope.data.mergedEntries = $scope.data.stream.entries.slice();
			for (var i = 0; i &lt; entries.length; i++) {
				existingEntries[entries[i].sys_id] = true;
			}

			return;
		}

		var mergedEntries = $scope.data.mergedEntries;
		for (var i = entries.length-1; i &gt;= 0; i--) {
			var curEntry = entries[i];
			if (isNewEntry(mergedEntries, curEntry)){
				mergedEntries.unshift(curEntry);
				existingEntries[curEntry.sys_id] = true;
			}
		}
	}

	function isNewEntry(mergedEntries, item) {
		for (var i=0; i &lt; mergedEntries.length; i++) {
			if (mergedEntries[i].sys_id === item.sys_id) {
				return false;
			}
		}
		return true;
	}

	$scope.getPlaceholder = function() {
		if ($scope.data.use_dynamic_placeholder &amp;&amp; $scope.data.useSecondaryJournalField)
			return $scope.data.secondaryJournalField.label;
		return $scope.placeholder;
	};

	var colorCache;
	$scope.getFieldColor = function(fieldName) {
		var defaultColor = "transparent";
		if (colorCache) {
			if (fieldName in colorCache)
				return colorCache[fieldName];
			else
				return defaultColor;
		}

		colorCache = {};
		var jf = $scope.data.stream.journal_fields;
		for (var i=0; i&lt;jf.length;i++) {
			colorCache[jf[i].name] = jf[i].color || defaultColor;
		}
		return $scope.getFieldColor(fieldName);
	}

	$scope.checkInLocation = function() {
		$rootScope.$broadcast("check_in_location");
		$rootScope.$broadcast("location.sharing.start");
	}

	$scope.$on("location.sharing.end", function() {
		$timeout(function() {$scope.msg = ""}, 500);
	})

	$scope.$on("location.sharing.start", function() {
		$scope.msg = $scope.data.sharingLocMsg;
	})

	$scope.scanBarcode = function() {
		$rootScope.$broadcast("scan_barcode");
	}

	$scope.$on("attachment.upload.start", function() {
		$scope.data.isPosting = true;
		$scope.msg = $scope.data.uploadingAttachmentMsg;
	})

	$scope.$on("attachment.upload.stop", function() {
		$scope.data.isPosting = false;
		$scope.msg = "";
		//update the stream so we get the new attachment
		spUtil.update($scope).then(function(r) {
			$scope.data.stream = r.stream;
		});
	});

	$scope.data.isPosting = false;

	$scope.postEntry = function(input) {
		post(input);
	};

	function post(input) {
		if ($scope.data.isPosting)
			return;

		if (!input)
			return;

		input = input.trim();
		$scope.data.journalEntry = input;

		if ($scope.data.useSecondaryJournalField)
			$scope.data.journalEntryField = $scope.data.secondaryJournalField.name;
		else
			$scope.data.journalEntryField = $scope.data.primaryJournalField.name;
		$scope.data.isPosting = true;
		spUtil.update($scope).then(function(){
			$scope.data.isPosting = false;
			reset();
			spAriaUtil.sendLiveMessage($scope.data.messagePostedMsg);
			$timeout(function() {
				$scope.setFocus(); // sets focus back on input, defined in "link"
			});
		});
		skipNextRecordWatchUpdate = true;
		$scope.setFocus(); // sets focus back on input, defined in "link"
	}

	var reset = function(){
		$scope.userTyping("");
		$scope.data.journalEntry = "";
		$scope.updateFormWithJournalFields();
		$scope.data.useSecondaryJournalField = false;
		$scope.data.journalEntryField = "";
	}

	$scope.keyPress = function(event) {
		if ($scope.data.isPosting) {
			if (event.keyCode === 13 &amp;&amp; !event.shiftKey)
				event.preventDefault();
			return;
		}
		
		if ($scope.data.enterKeyAddsNewLine)
			return; // must click Send button to submit
		
		if (event.keyCode === 13 &amp;&amp; !event.shiftKey) {
			event.preventDefault();
			$timeout(function() {
				if ($scope.data.journalEntry)
					$scope.postEntry($scope.data.journalEntry);
			}, 250);
		}
	}

	$scope.userTyping = function(input) {
		var status = "viewing";
		if (input.length)
			status = "typing";

		var field = $scope.data.useSecondaryJournalField ? $scope.data.secondaryJournalField.name : $scope.data.primaryJournalField.name;
		$scope.$emit("record.typing", {status: status, value: input, table: $scope.data.table, sys_id: $scope.data.sys_id, field_type: field});
		$scope.updateFormWithJournalFields();
	}
	$scope.updateFormWithJournalFields = function () {
		var fieldName, fieldToClear = "";
		if ($scope.data.useSecondaryJournalField) {
			fieldName = $scope.data.secondaryJournalField.name;
			fieldToClear = $scope.data.primaryJournalField.name;
		} else {
			fieldName = $scope.data.primaryJournalField.name;
			fieldToClear = "";
		}
		$scope.$emit("activity_stream_is_changed", {"fieldName": fieldName, "fieldToClear": fieldToClear, "input": $scope.data.journalEntry});
	}

	$scope.toggleTranslation = function(e) {
	    e.showDetails = !e.showDetails;
		var translationObject = c.data.translation;
	    e.toggleMsg = e.showDetails ? translationObject.hideMsg : translationObject.showMsg;
	};

	$scope.getTranslatedText = function(translations) {
	    if (!(Array.isArray(translations)))
	        return;
	    var translatedText;
	    var translationsLength = translations.length;
	    for (var index = 0; index &lt; translationsLength; index++) {
	        if (translations[index].targetLanguage === g_lang) {
	            translatedText = translations[index].translatedText;
	            break;
	        }
	    }
	    return translatedText;
	};

	$scope.getAdditionalParameters = function(e, isRetry) {
	    return {
	        'event': {
	            'eventName': 'Activity Stream - Portal',
	            'fieldType': e.element,
	            'retry': isRetry
	        },
	        'additionalParameters': [{
	            'parameterName': 'textType',
	            'parameterValue': 'html'
	        }, {
	            'parameterName': 'escapeHtml',
	            'parameterValue': e.contains_code
	        }]
	    };
	}

	$scope.showTranslationInProgress = function(e) {
	    e.showTranslation = true;
	    e.isTranslationInProgress = true;
	    e.isTranslationSuccess = false;
	    e.isTranslationError = false;
	}

	$scope.showTranslationSuccess = function(e, translatedText, credits) {
	    e.translatedText = translatedText;
	    e.credits = credits;
	    e.toggleMsg = c.data.translation.hideMsg;
	    e.isTranslationInProgress = false;
	    e.isTranslationSuccess = true;
	    e.isTranslationError = false;
	    e.showDetails = true;
	}

	$scope.showTranslationError = function(e, errorMessage, tryAgain) {
	    e.isTranslationInProgress = false;
	    e.isTranslationSuccess = false;
	    e.isTranslationError = true;
	    e.translatedText = errorMessage;
	    e.tryAgain = tryAgain;
	}

	$scope.translateText = function(e, isRetry) {
	    $scope.showTranslationInProgress(e);
	    var translationObject = c.data.translation;
	    dynamicTranslation.getTranslation(e.value, $scope.getAdditionalParameters(e, isRetry)).then(
	        function(successResponse) {
	            if (successResponse.detectedLanguage.code === g_lang) {
	                $scope.showTranslationError(e, translationObject.sameLanguageErrorMsg, false);
	                return;
	            }
	            var translatedText = $scope.getTranslatedText(successResponse.translations);
	            if (translatedText) {
	                var credits = i18n.format(translationObject.creditsMsg, successResponse.translator);
	                $scope.showTranslationSuccess(e, translatedText, credits);
	            } else {
	                translatedText = translationObject.genericErrorMsg;
	                $scope.showTranslationError(e, translatedText, true);
	            }
	        },
	        function(errorResponse) {
	            var errorCode = errorResponse.code;
	            var errorMessage;
	            var showRetry = false;
	            switch (errorCode) {
	                case '40052':
	                    errorMessage = translationObject.maxLengthErrorMsg;
	                    break;
	                case '40055':
	                    errorMessage = translationObject.credentialsErrorMsg;
	                    break;
	                case '40053':
	                case '40054':
	                case '40056':
	                    errorMessage = translationObject.langNotSupportedErrorMsg;
	                    break;
	                default:
	                    errorMessage = translationObject.genericErrorMsg;
	                    showRetry = true;
	            }
	            $scope.showTranslationError(e, errorMessage, showRetry);
	        }
	    );
	}
}]]&gt;&lt;/client_script&gt;&lt;controller_as&gt;c&lt;/controller_as&gt;&lt;css&gt;.panel-title {
  display: inline;
  font-size: 16px;
}

.panel-title-container {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.panel-title-icons {

  ul {
    display: flex;
    align-items: center;
    padding: 0;
    margin: 0;
  }
  li {
    padding: 0;
    margin: 0;

    .panel-button {
      display: flex;
      align-items: center;
      margin: 0 0 0 15px;
      line-height: initial;

      &amp;amp;:hover, &amp;amp;:focus {
        text-decoration: none;
      }
    }
  }
}


.timeline-heading test {
  float:right;
}

.timeline-body &amp;gt; p {
  white-space: pre-wrap;
  overflow-x: hidden;
}

.timeline-body ul &amp;gt; li {
  float: none;
}

.no-resize {
  resize: none;
}

.journal-field-indicator {
  width: 5px;
  position: absolute;
  left: 5px;
  top: 5px;
  bottom: 5px;
  z-index: 3;
}

.panel-heading {
  word-wrap: break-word;
  background: transparent;
  border: solid 1px #E5E5E5;
}

.avatar-container {
  cursor: default;
}

ul {
  list-style: none;
}

.overflow-hidden {
  overflow: hidden;
}


.timeline-badge-wrap {
  margin: auto;
  max-width: 115px;
}

.timeline-badge.success {
  background-color: $gray;
}

.timeline-badge {
  position: relative;
  left:25%;
  width:50%;
  padding-bottom:50%;
  border-radius:50%;
}

.timeline-badge span{
  position:absolute;
  top:50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size:13px;
  color: #fff;
}
.timeline &amp;gt; li &amp;gt; .timeline-panel{
  box-shadow: none;
  border-color: #BFBFBF;
  padding: 25px 20px;
}
.timeline &amp;gt; li.timeline-inverted &amp;gt; .timeline-panel:before {
  border-left: 0 solid #fff;
  border-right: 14px solid #BFBFBF;
}
}
.journal-type {
  display: inline-flex;
  display: -ms-inline-flexbox;
  flex-wrap: wrap;
  -webkit-justify-content: flex-end;
}

.fa-circle {
  font-size: 4px;
  padding: 7px;
}

.avatar-container .avatar .sub-avatar {
  background: $purple center;
}
@media (max-width: 768px) {
  .timeline-badge-wrap {
    margin: 0;
  }
  .timeline-badge {
    left: 10%;
  }
}

.translation-font {
  font-size: 12px;
}

.translate-link {
  cursor: pointer;
  @extend .translation-font;
}

.translation-credits {
  font-style: italic;
}

.translation-message {
  padding-top: 10px;
  font-size: 14px;
  white-space: pre-wrap;
}

.toggle-link-show {
  display: none;
}

.translation-credits {
  font-style: italic;
}

.translation-icon {
  width: 12px;
  height: 12px;
  padding-right: 4px;
  @extend .translation-font;
}

.translation-container {
  border: 1px solid $well-border;
  border-radius: 3px;
  background-color: $well-bg;
  padding: 10px;
  color: $text-color;
  margin-top: 10px;
  @extend .translation-font;
}

.translation-delimiter {
  padding: 7px;
  @extend .translation-font;
}

.translate-wrap {
  white-space: nowrap;
}
&lt;/css&gt;&lt;data_table&gt;sp_instance&lt;/data_table&gt;&lt;demo_data&gt;{"options": {
	"sys_id": -1,
		"table": "incident"
	}
}&lt;/demo_data&gt;&lt;description/&gt;&lt;docs/&gt;&lt;field_list/&gt;&lt;has_preview&gt;false&lt;/has_preview&gt;&lt;id&gt;acn_ticket_conversations&lt;/id&gt;&lt;internal&gt;false&lt;/internal&gt;&lt;link&gt;&lt;![CDATA[function(scope, elm) {
	// Set the focus back on the input for IE11
	scope.setFocus = function() {
		var input = $(elm[0]).find('textarea#post-input');
		if (input[0])
			input[0].focus();
	}
}]]&gt;&lt;/link&gt;&lt;name&gt;ACN Ticket Conversations&lt;/name&gt;&lt;option_schema&gt;[{"hint":"Placeholder text shows selected journal field","name":"use_dynamic_placeholder","section":"Behavior","label":"Use dynamic placeholder","type":"boolean"},{"hint":"Message to show when record has no readable journal field","name":"no_readable_journal_field_message","default_value":"","section":"Presentation","label":"No readable journal field message","type":"string"},{"hint":"Enter key behavior is specified by system property (glide.service_portal.comment.enter_adds_newline) unless overridden here","name":"enter_key_behavior","section":"Behavior","default_value":"System property","label":"Enter key behavior","type":"choice","choices":[{"label":"System property","value":"System property"},{"label":"Submit","value":"Submit"},{"label":"New line","value":"New line"}]}]&lt;/option_schema&gt;&lt;public&gt;false&lt;/public&gt;&lt;roles/&gt;&lt;script&gt;&lt;![CDATA[(function() {
	data.currentUserID = gs.getUserID();
	data.maxAttachmentSize = parseInt(gs.getProperty("com.glide.attachment.max_size", 1024));
	if (isNaN(data.maxAttachmentSize))
		data.maxAttachmentSize = 24;
	data.uploadingAttachmentMsg = gs.getMessage("Uploading attachment...");
	data.sharingLocMsg = gs.getMessage("Sharing location...");
	data.scanBarcodeMsg = gs.getMessage("Scan barcode");
	data.checkInLocMsg = gs.getMessage("Check in location");
	data.messagePostedMsg = gs.getMessage("Message has been sent");
	data.viewMsg = gs.getMessage("View");
	data.attachAddedMsg = gs.getMessage("Attachment added");
	data.attachFailMsg = gs.getMessage("Failed to add attachment");
	data.scanFailedMsg = gs.getMessage("File failed security scan");
	data.sys_id = (input &amp;&amp; input.sys_id) || options.sys_id || $sp.getParameter("sys_id");
	data.table = (input &amp;&amp; input.table) || options.table || $sp.getParameter("table");
	// don't use options.title unless sys_id and table also come from options
	if (options &amp;&amp; options.sys_id &amp;&amp; options.table)
		data.ticketTitle = options.title;
	data.placeholder = options.placeholder || gs.getMessage("Type your message here...");
	data.placeholderNoEntries = options.placeholderNoEntries || gs.getMessage("Type your message here...");
	data.btnLabel = options.btnLabel || gs.getMessage("Send");
	data.includeExtended = options.includeExtended || false;
	data.use_dynamic_placeholder = options.use_dynamic_placeholder;
	data.hideAttachmentBtn = options.hideAttachmentBtn;
	data.viewAttachmentMsg = gs.getMessage("View attachment");
	data.downloadAttachmentMsg = gs.getMessage("Download attachment");

	var translationLuaParameters = {
		'event': {
			'eventName': 'Activity Stream - Portal'
			}
		};
	var isDynamicTranslationInstalled = GlidePluginManager.isActive("com.glide.dynamic_translation");
	if (isDynamicTranslationInstalled) {
		var isDynamicTranslationEnabled	= sn_dt_api.DynamicTranslation.isEnabled(translationLuaParameters);
		data.isTranslationEnabled = isDynamicTranslationEnabled &amp;&amp; isDynamicTranslationEnabled.translation;
		if(data.isTranslationEnabled)
			initDynamicTranslation();
	}

	function initDynamicTranslation() {
	    var translation = {};
	    translation.translateLinkMsg = gs.getMessage("Translate");
	    translation.sameLanguageErrorMsg = gs.getMessage("This content is written in your preferred language. No need to translate.");
	    translation.genericErrorMsg = gs.getMessage("Unable to translate.");
	    translation.credentialsErrorMsg = gs.getMessage("Credentials are missing or invalid. Contact your administrator.");
	    translation.maxLengthErrorMsg = gs.getMessage("Text has exceeded the maximum length.");
	    translation.langNotSupportedErrorMsg = gs.getMessage("Text cannot be translated to your preferred language.");
	    translation.creditsMsg = gs.getMessage("Translated by {0}");
	    translation.translationProgressMsg = gs.getMessage("Translating...");
	    translation.hideMsg = gs.getMessage("Hide");
	    translation.showMsg = gs.getMessage("Show");
	    translation.tryAgainMsg = gs.getMessage("Try Again");
	    data.translation = translation;
	}

	data.enterKeyAddsNewLine = false;
	if (options.enter_key_behavior == "System property")
		data.enterKeyAddsNewLine = gs.getProperty("glide.service_portal.comment.enter_adds_newline") == "true";
	else if (options.enter_key_behavior == "New line")
		data.enterKeyAddsNewLine = true;

	var gr = new GlideRecord(data.table);
	if (!gr.isValid())
		return;

	gr.get(data.sys_id);
	if (!gr.canRead())
		return;

	data.isNewRecord = data.sys_id == -1 || gr.isNewRecord();
	data.table = gr.getRecordClassName(); // use actual table for the record
	options.no_readable_journal_field_message = options.no_readable_journal_field_message || gs.getMessage("No readable comment field");
	data.number = gr.getDisplayValue('number');
	data.created_on = gr.getValue('sys_created_on');

	if (input) { // if we have input then we're saving
		if (input.journalEntry &amp;&amp; input.journalEntryField){
			if (gr.canWrite(input.journalEntryField)){
				gr[input.journalEntryField].setDisplayValue(input.journalEntry);
				gr.update();
				$sp.logStat('Comments', data.table, data.sys_id, input.journalEntry);
			}
		}
		data.ticketTitle = input.ticketTitle;
		data.placeholder = input.placeholder;
		data.btnLabel = input.btnLabel;
		data.includeExtended = input.includeExtended;
	} else {
		if (!data.ticketTitle) {
			if (gr.short_description.canRead())
				data.ticketTitle = gr.getDisplayValue("short_description");
			if (!data.ticketTitle)
				data.ticketTitle = data.number;
		}

		$sp.logStat('Task View', data.table, data.sys_id);
	}

	data.canWrite = gr.canWrite();
	data.canAttach = userCanAttach(gr);
	data.canRead = gr.canRead();
	data.hasWritableJournalField = false;
	data.hasReadableJournalField = false;
	if (data.canRead &amp;&amp; !data.isNewRecord) {
		data.stream = $sp.getStream(data.table, data.sys_id);
		// Journal fields come in correct order already
		// so grab the first 2 writeable fields
		if ('journal_fields' in data.stream) {
			var jf = data.stream.journal_fields;
			for(var i=0; i &lt; jf.length; i++){
				if (jf[i].can_read === true)
					data.hasReadableJournalField = true;
				if (jf[i].can_write === true){
					data.hasWritableJournalField = true;
					if (!data.primaryJournalField)
						data.primaryJournalField = jf[i];
					else if (data.includeExtended &amp;&amp; !data.secondaryJournalField)
						data.secondaryJournalField = jf[i];
					else
						break;
				}
			}
		}

	}

	data.tableLabel = gr.getLabel();

	function userCanAttach(originalRecord) {
		if (!gs.hasRole(gs.getProperty("glide.attachment.role")))
			return false;
		
		// To check whether user can upload attachments, need to check "no_attachment" table
		// attribute of the target record (e.g., incident vs. task), so fetch it if we need to.
		// GlideRecordScriptUtil.getRealRecord is not available to scoped apps, so can't use it.
		var targetRecordForAttributes = originalRecord;
		if (originalRecord.getRecordClassName() != originalRecord.getTableName()) {
			targetRecordForAttributes = new GlideRecord(originalRecord.getRecordClassName());
			targetRecordForAttributes.get(originalRecord.getUniqueValue());
		}
		return targetRecordForAttributes.getAttribute("no_attachment") != "true";
	}

})()]]&gt;&lt;/script&gt;&lt;servicenow&gt;false&lt;/servicenow&gt;&lt;sys_class_name&gt;sp_widget&lt;/sys_class_name&gt;&lt;sys_created_by&gt;Anna.Organize&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2021-01-22 18:57:19&lt;/sys_created_on&gt;&lt;sys_id&gt;556520f21b796050c7bbea8ce54bcb2b&lt;/sys_id&gt;&lt;sys_mod_count&gt;20&lt;/sys_mod_count&gt;&lt;sys_name&gt;ACN Ticket Conversations&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sp_widget_556520f21b796050c7bbea8ce54bcb2b&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;mateus.anzolin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2021-02-02 19:19:05&lt;/sys_updated_on&gt;&lt;template&gt;&lt;![CDATA[&lt;div&gt;
&lt;div ng-if="!data.canRead &amp;&amp; !data.isNewRecord"&gt;
    ${Requested record not found}
  &lt;/div&gt;
&lt;div ng-if="data.canRead &amp;&amp; !data.isNewRecord" class="panel clean panel-{{options.color}} b ticket_conversation"&gt;
&lt;div class="panel-heading"&gt;

&lt;div class="h2 panel-title panel-title-container"&gt;
&lt;h2 class="h4 panel-title" aria-label="{{::data.ticketTitle}} ${Ticket history}"&gt;{{::data.ticketTitle}}&lt;/h2&gt;

&lt;div class="pull-right panel-title-icons"&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;button href ng-show="data.showLocationIcon &amp;&amp; data.canWrite" class="panel-button btn btn-link" ng-click="checkInLocation()" title="{{data.checkInLocMsg}}"&gt;
&lt;span class="glyphicon glyphicon-globe"&gt;&lt;/span&gt;
&lt;/button&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;button href class="panel-button btn btn-link" ng-show="isNative" ng-click="scanBarcode()" title="{{data.scanBarcodeMsg}}"&gt;
&lt;span class="glyphicon glyphicon-barcode"&gt;&lt;/span&gt;
&lt;/button&gt;
&lt;/li&gt;
&lt;li ng-if="::(!data.hideAttachmentBtn)"&gt;&lt;sp-attachment-button ng-if="::data.canWrite &amp;&amp; data.canAttach"&gt;&lt;/sp-attachment-button&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class="panel-body"&gt;
&lt;!--FLOW STEPS--&gt;  
 &lt;widget id="acn_proccess_flow"&gt;&lt;/widget&gt;
&lt;!-- END --&gt;  
&lt;div ng-if="data.hasReadableJournalField"&gt;
&lt;form ng-submit="postEntry(data.journalEntry)" id="sand"&gt;
&lt;div ng-show="data.hasWritableJournalField" class="input-group"&gt;
&lt;textarea ng-keypress="keyPress($event)" sn-resize-height="trim" rows="1" id="post-input" class="form-control no-resize overflow-hidden" ng-model='data.journalEntry' ng-model-options='{debounce: 250}' ng-attr-placeholder="{{getPlaceholder()}}" aria-label="{{getPlaceholder()}}" autocomplete="off" ng-change="userTyping(data.journalEntry)"/&gt;
&lt;span class="journal-field-indicator" ng-style="({'background-color': data.useSecondaryJournalField ? data.secondaryJournalField.color : data.primaryJournalField.color})"&gt;&lt;/span&gt;
&lt;span class="input-group-btn" style="vertical-align: top"&gt;
&lt;input type="submit" class="btn btn-primary" value="{{data.btnLabel}}" ng-disabled="data.isPosting"/&gt;
&lt;/span&gt;
&lt;/div&gt;
&lt;div ng-if="::(data.secondaryJournalField &amp;&amp; data.secondaryJournalField.can_write)"&gt;
&lt;label class="pull-right"&gt;
&lt;input type="checkbox" ng-model="::data.useSecondaryJournalField" ng-change="updateFormWithJournalFields()"/&gt;
&lt;span&gt; {{::data.secondaryJournalField.label}}&lt;/span&gt;
&lt;/label&gt;
&lt;/div&gt;
&lt;/form&gt;
&lt;ul class="list-group m-b-none" ng-if="typing.length &gt; 0"&gt;
&lt;li class="list-group-item user-typing m-t" ng-repeat="u in typing"&gt;${{{::u.user_display_name}} is typing}&lt;/li&gt;
&lt;/ul&gt;
&lt;ul class="list-group m-b-none m-t" ng-if="msg"&gt;
&lt;li class="list-group-item user-typing"&gt;{{msg}}&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="timeline-container"&gt;
&lt;ul role="list" class="timeline" aria-label="${Ticket history}"&gt;
&lt;li class="timeline-item" ng-class="::{'timeline-inverted': e.user_sys_id == data.currentUserID}" ng-repeat="e in data.mergedEntries"&gt;
&lt;div class="timeline-badge"&gt;
&lt;sn-avatar-once ng-if="hasLiveProfile(e.user_sys_id)" primary="getLiveProfileByUserId(e.user_sys_id)" class="avatar-large" show-presence="false" enable-context-menu="false"&gt;
&lt;/sn-avatar-once&gt;
&lt;/div&gt;
&lt;div class="timeline-panel"&gt;
&lt;div class="timeline-panel-inner" ng-style="::{'border-color': getFieldColor(e.element)}"&gt;
&lt;div class="timeline-heading"&gt;
&lt;div class="timeline-title h4"&gt;{{::e.name}}&lt;/div&gt;
&lt;p class = "time-text"&gt;
&lt;small class="text-muted"&gt;
&lt;span class="glyphicon glyphicon-time" aria-hidden="true" tabindex="-1" /&gt;
&lt;sn-time-ago timestamp="::e.sys_created_on" /&gt;
&lt;/small&gt;
&lt;i ng-if="::e.field_label" class="fa fa-circle text-muted" aria-hidden="true"&gt;&lt;/i&gt;
&lt;small class = "text-muted journal-type"&gt;{{::e.field_label}}&lt;/small&gt;
&lt;span ng-if= "::((e.element == 'comments' || e.element == 'work_notes') &amp;&amp; data.isTranslationEnabled)"&gt;
&lt;small class="text-muted translation-delimiter"&gt;•&lt;/small&gt;
&lt;span class="translate-wrap"&gt;
&lt;i class="text-muted translation-icon icon-translation"&gt;&lt;/i&gt;
&lt;a class="translate-link" role="button" href="javascript:void(0)" ng-click="translateText(e, false)"&gt;{{::data.translation.translateLinkMsg}}&lt;/a&gt;
&lt;/span&gt;
&lt;/span&gt;
&lt;/p&gt;
&lt;/div&gt;
&lt;div class="timeline-body"&gt;
&lt;p ng-if="::(e.element != 'attachment')" ng-bind-html="::e.value"&gt;&lt;/p&gt;
&lt;div ng-if="::(e.element == 'attachment')"&gt;
&lt;a ng-if="(e.attachment.state == 'available')" target="_blank" href="/sys_attachment.do?view=true&amp;sys_id={{::e.attachment.sys_id}}" aria-label="{{e.attachment.viewImage ? data.viewAttachmentMsg : data.downloadAttachmentMsg}} {{::e.attachment.file_name}}"&gt;
&lt;img ng-if="e.attachment.thumbnail_path" alt="" ng-src="/{{::e.attachment.path}}?t=medium" class="img-responsive"/&gt;
&lt;/a&gt;
&lt;a ng-if="(e.attachment.state == '' || e.attachment.state == 'pending' || e.attachment.state == 'available_conditionally')" ng-click="scanAttachment(e.attachment)" href="javascript:void(0)" aria-label="{{e.attachment.viewImage ? data.viewAttachmentMsg : data.downloadAttachmentMsg}} {{::e.attachment.file_name}}"&gt;
&lt;img ng-if="e.attachment.thumbnail_path" alt="" ng-src="/{{::e.attachment.path}}?t=medium" class="img-responsive"/&gt;
&lt;/a&gt;
&lt;div&gt;
&lt;div ng-if="(e.attachment.state == 'available')"&gt;
&lt;a href="/sys_attachment.do?sys_id={{::e.attachment.sys_id}}" target="_blank" title="{{dataViewMsg}}"&gt;&lt;strong&gt;{{e.attachment.file_name}}&lt;/strong&gt;&lt;/a&gt;&lt;br/&gt;
                        {{::e.attachment.size}}
                      &lt;/div&gt;
&lt;div ng-if="(e.attachment.state == 'not_available')"&gt;
&lt;span title="{{dataViewMsg}}" class="not_available"&gt;{{e.attachment.file_name}}&lt;/span&gt;&lt;br/&gt;
&lt;span class="error"&gt;{{::data.scanFailedMsg}}&lt;/span&gt;
&lt;/div&gt;
&lt;div ng-if="(e.attachment.state == '' || e.attachment.state == 'pending' || e.attachment.state == 'available_conditionally')"&gt;
&lt;a href="javascript:void(0)" ng-click="scanAttachment(e.attachment)" title="{{dataViewMsg}}"&gt;&lt;strong&gt;{{e.attachment.file_name}}&lt;/strong&gt;&lt;/a&gt;&lt;br/&gt;
                        {{::e.attachment.size}}
                      &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div ng-if="e.showTranslation" class="translation-container"&gt;
&lt;div ng-if="e.isTranslationInProgress"&gt;
&lt;i class="translation-icon icon-translation"&gt;&lt;/i&gt;
&lt;span aria-live="polite"&gt;{{::data.translation.translationProgressMsg}}&lt;/span&gt;
&lt;/div&gt;
&lt;div ng-if="e.isTranslationSuccess"&gt;
&lt;i class="translation-icon icon-translation"&gt;&lt;/i&gt;
&lt;a class="translate-link" role="button" href="javascript:void(0)" ng-click="toggleTranslation(e)"&gt;{{e.toggleMsg}}&lt;/a&gt;
&lt;span class="translation-delimiter"&gt;•&lt;/span&gt;
&lt;span class="translation-credits"&gt;{{e.credits}}&lt;/span&gt;
&lt;div ng-if="e.showDetails" class="translation-message" ng-bind-html="::e.translatedText"&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div ng-if="e.isTranslationError"&gt;
&lt;i class="translation-icon icon-translation"&gt;&lt;/i&gt;
{{e.translatedText}}
&lt;a ng-if="e.tryAgain" role="button" href="javascript:void(0)" class="translate-link" ng-click="translateText(e, true)"&gt;{{::data.translation.tryAgainMsg}}&lt;/a&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;li role="listitem" class="timeline-item" ng-class="::{'timeline-inverted': data.stream.user_sys_id == data.currentUserID}" aria-label="{{data.stream.user_full_name}}"&gt;
&lt;div class="timeline-badge"&gt;
&lt;sn-avatar-once ng-if="hasLiveProfile(data.stream.user_sys_id)" primary="getLiveProfileByUserId(data.stream.user_sys_id)" class="avatar-large" show-presence="false" enable-context-menu="false"&gt;
&lt;/sn-avatar-once&gt;
&lt;/div&gt;
&lt;div class="timeline-panel timeline-panel-first-item"&gt;
&lt;div class="timeline-heading"&gt;
&lt;div class="timeline-title h4"&gt;{{data.stream.user_full_name}}&lt;/div&gt;
&lt;p&gt;
&lt;small class="text-muted"&gt;
&lt;span class="glyphicon glyphicon-time" aria-hidden="true" tabindex="-1" /&gt;
&lt;sn-time-ago timestamp="data.created_on" /&gt;
&lt;/small&gt;
&lt;/p&gt;
&lt;/div&gt;
&lt;div class="timeline-body"&gt;
&lt;p&gt;{{data.number}} ${Created}&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;li role="presentation" aria-hidden="true"&gt;
&lt;div class="timeline-badge-wrap"&gt;
&lt;div class="timeline-badge success"&gt;
&lt;span&gt;${Start}&lt;/span&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div ng-if="!data.hasReadableJournalField"&gt;
        {{options.no_readable_journal_field_message}}
      &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;]]&gt;&lt;/template&gt;&lt;/sp_widget&gt;&lt;/record_update&gt;</payload>
<payload_hash>-797381055</payload_hash>
<remote_update_set display_value="ACN: Page - Tickets">bb26919607c220107a0af0269c1ed0dd</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>mateus.anzolin</sys_created_by>
<sys_created_on>2021-02-02 19:29:13</sys_created_on>
<sys_id>f726919607c220107a0af0269c1ed0e0</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>177642f1f2a0000001</sys_recorded_at>
<sys_updated_by>mateus.anzolin</sys_updated_by>
<sys_updated_on>2021-02-02 19:29:13</sys_updated_on>
<table/>
<target_name>ACN Ticket Conversations</target_name>
<type>Widget</type>
<update_domain>global</update_domain>
<update_guid>efd3ddd2c7c220104d30301094f2e806</update_guid>
<update_guid_history>efd3ddd2c7c220104d30301094f2e806:-797381055,37c2700de3022010a62d77bca0b0144b:-1911363579</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sp_instance_44a4780d070220107a0af0269c1ed0e8</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_instance"><sp_instance action="INSERT_OR_UPDATE"><active>true</active><class_name/><color>default</color><css/><glyph/><id/><order>2</order><roles/><short_description/><size>md</size><sp_column display_value="2">1683f80d070220107a0af0269c1ed0ad</sp_column><sp_widget display_value="ACN Ticket Attachments">dd74704d070220107a0af0269c1ed0bf</sp_widget><sys_class_name>sp_instance</sys_class_name><sys_created_by>mateus.anzolin</sys_created_by><sys_created_on>2021-01-29 19:50:11</sys_created_on><sys_id>44a4780d070220107a0af0269c1ed0e8</sys_id><sys_mod_count>0</sys_mod_count><sys_name/><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sp_instance_44a4780d070220107a0af0269c1ed0e8</sys_update_name><sys_updated_by>mateus.anzolin</sys_updated_by><sys_updated_on>2021-01-29 19:50:11</sys_updated_on><title/><url/><widget_parameters/></sp_instance><sys_translated_text action="delete_multiple" query="documentkey=44a4780d070220107a0af0269c1ed0e8"/></record_update>]]></payload>
<payload_hash>-262338180</payload_hash>
<remote_update_set display_value="ACN: Page - Tickets">bb26919607c220107a0af0269c1ed0dd</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>mateus.anzolin</sys_created_by>
<sys_created_on>2021-02-02 19:29:13</sys_created_on>
<sys_id>fb26919607c220107a0af0269c1ed0df</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>1774fb226410000001</sys_recorded_at>
<sys_updated_by>mateus.anzolin</sys_updated_by>
<sys_updated_on>2021-02-02 19:29:13</sys_updated_on>
<table/>
<target_name/>
<type>Instance</type>
<update_domain>global</update_domain>
<update_guid>88a4780d90022010add5e743238bbae9</update_guid>
<update_guid_history>88a4780d90022010add5e743238bbae9:-262338180</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>db_image_2a28bccd070220107a0af0269c1ed008</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="db_image"><db_image action="INSERT_OR_UPDATE"><active>true</active><category>Service Portal</category><format/><height/><image>4448f801074220107a0af0269c1ed068</image><name>reject-icon.svg</name><size_bytes>695</size_bytes><sys_class_name>db_image</sys_class_name><sys_created_by>mateus.anzolin</sys_created_by><sys_created_on>2021-01-29 20:05:54</sys_created_on><sys_id>2a28bccd070220107a0af0269c1ed008</sys_id><sys_mod_count>2</sys_mod_count><sys_name>reject-icon.svg</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>db_image_2a28bccd070220107a0af0269c1ed008</sys_update_name><sys_updated_by>mateus.anzolin</sys_updated_by><sys_updated_on>2021-01-29 20:06:02</sys_updated_on><thumbnail/><width/></db_image><sys_attachment action="INSERT_OR_UPDATE"><average_image_color/><chunk_size_bytes>700000</chunk_size_bytes><compressed>true</compressed><content_type>image/svg+xml</content_type><file_name>image</file_name><hash>bba313098f1d28542ae73ff27d8dd928b6a3b954ca7a5f56bfa7ea4f1ecc941d</hash><image_height/><image_width/><size_bytes>695</size_bytes><size_compressed>288</size_compressed><state>pending</state><sys_created_by>mateus.anzolin</sys_created_by><sys_created_on>2021-01-29 20:06:01</sys_created_on><sys_id>4448f801074220107a0af0269c1ed068</sys_id><sys_mod_count>2</sys_mod_count><sys_updated_by>mateus.anzolin</sys_updated_by><sys_updated_on>2021-01-29 20:06:01</sys_updated_on><table_name>ZZ_YYdb_image</table_name><table_sys_id>2a28bccd070220107a0af0269c1ed008</table_sys_id></sys_attachment><sys_attachment_doc action="INSERT_OR_UPDATE"><data>H4sIAAAAAAAAAA==</data><length>16</length><position>0</position><sys_attachment display_value="image" sys_id="4448f801074220107a0af0269c1ed068">4448f801074220107a0af0269c1ed068</sys_attachment><sys_created_by>mateus.anzolin</sys_created_by><sys_created_on>2021-01-29 20:06:01</sys_created_on><sys_id>8448f801074220107a0af0269c1ed068</sys_id></sys_attachment_doc><sys_attachment_doc action="INSERT_OR_UPDATE"><data>xZLBTsQgEIbv+xQEz9IBCrRm2UR78eLVg7dmW1u0lqbFZX17aVq66gO4Ccnw/WRm/vxhP50a5E3lWo0ZYNTWpmlduFOMTqb2D/asMSBALJygvZqu07i3fY3R+aPrJ41b54a7JPHeE8+JHZuEAUASBuPDbj+UrkWVxk85yfM8SxHNSMZ5WtCUSGAs8lw554EFocDEhYEIAFpEFiTLlaIo9jNCpVQCxfkrF4LwXKVye6dESiku7Qtu01dcl8fmaO6P+ReMJjfa91rjG3bP0jmZRbi1Q3k07iuERpTY1JjwJnSmr4/loPFoP/vql/xmTR/15GeCFBDl837+GGwDZPxaNtSS6fOa3n/amP/VYfcNzLV/crcCAAA=</data><length>372</length><position>1</position><sys_attachment display_value="image" sys_id="4448f801074220107a0af0269c1ed068">4448f801074220107a0af0269c1ed068</sys_attachment><sys_created_by>mateus.anzolin</sys_created_by><sys_created_on>2021-01-29 20:06:01</sys_created_on><sys_id>0848f801074220107a0af0269c1ed068</sys_id></sys_attachment_doc></record_update>]]></payload>
<payload_hash>131919161</payload_hash>
<remote_update_set display_value="ACN: Page - Tickets">bb26919607c220107a0af0269c1ed0dd</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>mateus.anzolin</sys_created_by>
<sys_created_on>2021-02-02 19:29:12</sys_created_on>
<sys_id>ff26919607c220107a0af0269c1ed0dd</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>1774fc0a8d80000001</sys_recorded_at>
<sys_updated_by>mateus.anzolin</sys_updated_by>
<sys_updated_on>2021-02-02 19:29:12</sys_updated_on>
<table/>
<target_name>reject-icon.svg</target_name>
<type>Images</type>
<update_domain>global</update_domain>
<update_guid>9848f80132422010ec98f4f472e16b71</update_guid>
<update_guid_history>9848f80132422010ec98f4f472e16b71:131919161,8848f801944220109ba93380acd5d16e:1895542216,c048f801a9422010dea2b5754637176c:1108509590,5a38b801a94220102e88fd7847b829ed:-967982821</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sp_column_5e83f80d070220107a0af0269c1ed0aa</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_column"><sp_column action="INSERT_OR_UPDATE"><class_name/><order>1</order><size>9</size><size_lg/><size_sm/><size_xs/><sp_row display_value="1">9283340d070220107a0af0269c1ed06b</sp_row><sys_class_name>sp_column</sys_class_name><sys_created_by>mateus.anzolin</sys_created_by><sys_created_on>2021-01-29 19:45:25</sys_created_on><sys_id>5e83f80d070220107a0af0269c1ed0aa</sys_id><sys_mod_count>0</sys_mod_count><sys_name>1</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sp_column_5e83f80d070220107a0af0269c1ed0aa</sys_update_name><sys_updated_by>mateus.anzolin</sys_updated_by><sys_updated_on>2021-01-29 19:45:25</sys_updated_on></sp_column></record_update>]]></payload>
<payload_hash>-648138915</payload_hash>
<remote_update_set display_value="ACN: Page - Tickets">bb26919607c220107a0af0269c1ed0dd</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>mateus.anzolin</sys_created_by>
<sys_created_on>2021-02-02 19:29:13</sys_created_on>
<sys_id>ff26919607c220107a0af0269c1ed0de</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>1774fadc99c0000001</sys_recorded_at>
<sys_updated_by>mateus.anzolin</sys_updated_by>
<sys_updated_on>2021-02-02 19:29:13</sys_updated_on>
<table/>
<target_name>1</target_name>
<type>Column</type>
<update_domain>global</update_domain>
<update_guid>d683f80dd0022010d6f0a6ab94fdd2ac</update_guid>
<update_guid_history>d683f80dd0022010d6f0a6ab94fdd2ac:-648138915</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
</unload>
